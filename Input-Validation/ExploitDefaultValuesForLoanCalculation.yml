id: EXPLOITING_DEFAULT_VALUES_FOR_LOAN_CALCULATION
info:
  name: "Exploiting Default Values for Loan Calculation"
  description: >
    "This test evaluates the system's handling of default values in loan calculations to ensure that the application does not apply unintended or incorrect defaults when critical parameters are missing. The objective is to identify scenarios where a user might omit certain parameters (such as loan duration) to manipulate the default interest rate or other values used in the loan calculation, potentially resulting in more favorable loan terms."
  details: >
    "The test involves sending API requests with some required fields omitted, such as `duration`, to determine if the application applies default values that may be more beneficial to the user than intended. For example, a user may omit the `duration` field when requesting a loan calculation, hoping that the system defaults to a lower interest rate or longer repayment term. The test checks whether the application correctly handles such missing inputs and applies appropriate default values based on policy or constraints."
  impact: >
    "Exploiting default values in loan calculations can lead to incorrect loan terms, such as a lower interest rate or extended repayment period, which could result in financial losses for the lender. If the server does not properly handle missing parameters and defaults to unintended values, it compromises the integrity of the loan process and could lead to financial risks or fraudulent activities. Ensuring robust validation and application of default values is essential to prevent exploitation and maintain the fairness and accuracy of loan offerings."

  category:
    name: INPUT
    shortName: Input Validation
    displayName: Input Validation (INPUT)
  subCategory: EXPLOITING_DEFAULT_VALUES_FOR_LOAN_CALCULATION
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/
    - https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html
    - https://owasp.org/www-project-developer-guide/draft/design/web_app_checklist/validate_inputs/
  cwe:
    - CWE-20
  cve:
    - CVE-2018-20679
    - CVE-2019-14271
attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST


api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    neq: OPTIONS
  response_payload:
    length:
      gt: 0
    not_contains:
      - Error
      - Internal Server
      - Failed
      - Unauthorized
      - access denied
      - Forbidden
      - Method Not allowed
      - Gateway timeout
      - request timeout
      - server error
      - server busy
      - authentication error
      - authorization error
      - validation error
      - Permission Denied
      - invalid token
      - token expired
      - session expired
      - session timeout
      - unexpected error
      - unable to process request
      - bad request
      - service unavailable
      - account is locked
      - account is blocked
      - multiple failed attempts
    for_one:
      key:
        regex: "${probableOutputParameters}"
        extract: outputUserKey
      value:
        extract: outputUserValue
  request_payload:
    for_one:
      key:
        regex: "${probableInputParameters}"
        extract: userKey

wordLists:
  probableInputParameters:
    - duration
    - loanDuration
    - repaymentDuration
    - loanTerm
    - term
    - period
    - repaymentPeriod
    - loanPeriod
    - paymentTerm
    - installmentDuration
    - numberOfMonths
    - months
    - years

  probableOutputParameters:
    - interestRate
    - interest_rate
    - appliedInterestRate
    - effectiveInterestRate
    - annualPercentageRate
    - apr
    - nominalRate
    - defaultInterestRate
    - calculatedInterestRate
    - baseRate
    - monthlyRate
    - discountRate

execute:
  type: single
  requests:
    - req:
        - delete_body_param: ${userKey}

validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
    not_contains:
      - Error
      - Internal Server
      - Failed
      - Unauthorized
      - access denied
      - Forbidden
      - Method Not allowed
      - Gateway timeout
      - request timeout
      - server error
      - server busy
      - authentication error
      - authorization error
      - validation error
      - Permission Denied
      - invalid token
      - token expired
      - session expired
      - session timeout
      - unexpected error
      - unable to process request
      - bad request
      - service unavailable
      - account is locked
      - account is blocked
      - multiple failed attempts
      - Attention Required!
      - CloudFlare
      - "Sorry, you have been blocked"
    for_one:
      key:
        eq: "${outputUserKey}"
      value:
        neq: "${outputUserValue}"
