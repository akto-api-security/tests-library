id: GIT_CONFIG_NGINXOFFBYSLASH
info:
  name: Nginx - Git Configuration Exposure
  description: "Nginx is vulnerable to git configuration exposure."
  details: >
    "Nginx - Git Configuration Exposure refers to the vulnerability where Nginx servers are susceptible to git configuration exposure due to an off-by-slash misconfiguration. By appending "../" in the URL path, unauthorized access to Git configuration files, such as /.git/config, is possible. Promptly addressing this vulnerability is essential to prevent unauthorized access, protect the confidentiality of repository data, and maintain the security of Nginx servers."
  impact: "Exploiting the off-by-slash misconfiguration in Nginx exposes Git configuration files, revealing sensitive information such as repository configurations, URLs, and credentials. This enables attackers to gain unauthorized access, manipulate code, and launch further attacks."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: GIT_CONFIG_NGINXOFFBYSLASH
  severity: MEDIUM
  references:
    - https://beaglesecurity.com/blog/vulnerability/nginx-off-by-slash-exposes-git-config.html
    - https://twitter.com/Random_Robbie/status/1262676628167110656
    - https://github.com/PortSwigger/nginx-alias-traversal/blob/master/off-by-slash.py
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-22
  cve:
    - CVE-2021-23017

attributes:
  nature: NON_INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

wordLists:
  urlPaths:
    - ${urlVar}/static../.git/config
    - ${urlVar}/js../.git/config
    - ${urlVar}/images../.git/config
    - ${urlVar}/img../.git/config
    - ${urlVar}/css../.git/config
    - ${urlVar}/assets../.git/config
    - ${urlVar}/content../.git/config
    - ${urlVar}/events../.git/config
    - ${urlVar}/media../.git/config
    - ${urlVar}/lib../.git/config

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlPaths}

validate:
  response_code:
    eq: 200
  response_payload:
    not_contains:
      - <html>
      - </html>
    length:
      gt: 0
    contains_all:
      - '[core]'

