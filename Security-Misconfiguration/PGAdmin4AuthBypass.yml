id: PGADMIN4_AUTH_BYPASS
info:
  name: "pgadmin 4 Authentication Bypass Test"
  description: "The pgAdmin 4 Authentication Bypass Test involves checking whether pgAdmin 4, the web-based PostgreSQL administration tool, can be accessed without proper authentication. This vulnerability may allow attackers to bypass login mechanisms and gain unauthorized access to the pgAdmin interface, where they could manipulate databases, execute malicious queries, or steal sensitive data. Detecting this issue is crucial for ensuring that pgAdmin is properly secured with strong authentication controls to prevent unauthorized access. Implementing proper access restrictions and applying security patches can mitigate this risk."
  details: "The pgAdmin 4 Authentication Bypass Test checks for flaws in the authentication process of pgAdmin 4 that may allow unauthorized access. Attackers can exploit weaknesses, such as improper session management or insecure default configurations, to bypass login mechanisms and gain access to the pgAdmin interface without credentials. Once bypassed, they could potentially perform actions such as database manipulation, data exfiltration, or executing arbitrary SQL queries. It is important to secure pgAdmin 4 with strong authentication, proper session handling, and up-to-date security patches to prevent such attacks."
  impact: "The impact of a pgAdmin 4 Authentication Bypass vulnerability is significant, as it could allow unauthorized users to access and control PostgreSQL databases without proper credentials. This could lead to data manipulation, unauthorized querying, or even complete data exfiltration. Attackers could also alter critical database configurations or introduce malicious queries. To mitigate such risks, strong authentication mechanisms, session management, and regular security updates are essential to prevent unauthorized access and protect sensitive data."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: PGADMIN4_AUTH_BYPASS
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/login?next=/'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    not_contains:
      - 'OAUTH2_CLIENT_SECRET": null'
    contains_all:
      - '<title>pgAdmin 4</title>'
      - 'OAUTH2_CLIENT_SECRET'
strategy:
  run_once: /
settings:
  duration: FAST
