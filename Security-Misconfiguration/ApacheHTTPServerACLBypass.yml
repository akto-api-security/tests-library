id: APACHE_HTTP_SERVER_ACL_BYPASS
info:
  name: "Apache HTTP Server ACL Bypass Test"
  description: "The Apache HTTP Server ACL Bypass Test checks for vulnerabilities in the Access Control List (ACL) configuration of the Apache HTTP Server. ACLs are used to control access to resources based on user roles or IP addresses, but improper configuration or weaknesses may allow unauthorized users to bypass these restrictions. This test aims to identify misconfigurations that could enable attackers to access restricted resources, compromising server security. Proper ACL management and regular configuration reviews are essential to secure Apache servers against unauthorized access."
  details: "The Apache HTTP Server ACL Bypass Test focuses on identifying flaws or misconfigurations in the server's Access Control List (ACL) settings that may allow unauthorized users to bypass access restrictions. For example, an ACL might incorrectly grant access to sensitive directories or resources, or allow certain users or IP addresses to bypass defined access rules. Attackers exploiting this vulnerability could gain unauthorized access to files, configuration settings, or administrative interfaces. To mitigate such risks, it's important to review and securely configure ACLs, ensuring they properly enforce access control policies."
  impact: "The impact of an Apache HTTP Server ACL Bypass can be severe, as it may allow unauthorized users to access restricted resources, sensitive data, or administrative interfaces. Exploiting this vulnerability could lead to data leaks, unauthorized modifications, or system compromise. Attackers could bypass security policies, potentially escalating privileges or executing malicious actions on the server. To mitigate these risks, proper ACL configurations, regular reviews, and strong access controls are essential for securing the Apache HTTP Server."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: APACHE_HTTP_SERVER_ACL_BYPASS
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


attributes:
  nature: NON_INTRUSIVE
  plan: PRO
  duration: FAST
compliance_standards: compliance/security-misconfiguration.conf

api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/html/usr/share/doc/hostname/copyright%3f'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - "On Debian systems, the complete text of the GNU General Public License"
      - "This package was written by Peter Tobias"
strategy:
  run_once: /
