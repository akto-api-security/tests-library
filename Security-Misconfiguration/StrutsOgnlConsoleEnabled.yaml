id: STRUTS_OGNL_CONSOLE_ENABLED
info:
  name: Struts OGNL Console Enabled
  description: "Detection of Struts OGNL console enabled misconfiguration, which can lead to remote code execution vulnerabilities."
  details: >
    The Struts OGNL Console Enabled test identifies a security misconfiguration where the OGNL  (Object-Graph Navigation Language) console in Struts framework is accessible. By modifying the URL and  appending "struts/webconsole.html?debug=console," the test checks if the OGNL console is enabled and  accessible. Enabling the OGNL console can lead to remote code execution vulnerabilities, allowing  attackers to execute arbitrary code on the server. This misconfiguration falls under the Security  Misconfiguration category with a low severity level. Disabling the OGNL console is essential to prevent  potential remote code execution and enhance application security.
  impact: "Enabling Struts OGNL console exposes the application to remote code execution, allowing attackers to execute arbitrary code on the server."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: Server Misconfiguration
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    - "https://struts.apache.org/core-developers/development-mode"
    - "https://nvd.nist.gov/vuln/detail/CVE-2020-17530"
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-215

attributes:
  nature: INTRUSIVE
  plan: STANDARD
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlVar}/struts/webconsole.html?debug=console

validate:
  response_code:
    eq: 200
  response_payload:
    contains_all:
      - 'Welcome to the OGNL console!'
