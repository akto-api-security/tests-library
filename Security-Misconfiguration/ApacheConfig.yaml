id: APACHE_CONFIG
info:
  name: Apache Config file disclosure
  description: "Attackers can get access to the Apache configuration files."
  details: >
    "Apache Config File Disclosure refers to the vulnerability where Apache configuration files are exposed due to misconfiguration. This exposes sensitive information about the server's setup and security measures. Attackers can exploit this vulnerability to gain insights into the server's configuration, potentially identifying weaknesses and planning targeted attacks. Promptly addressing this issue is important to prevent unauthorized access and protect the server from potential security risks."
  impact: "Attackers can exploit the exposed configuration files to gain insights into the server's configuration, potentially identifying vulnerabilities and planning targeted attacks. The impact may vary depending on the specific information disclosed in the files."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: APACHE_CONFIG
  severity: LOW
  references:
    - https://www.apachelounge.com/viewtopic.php?t=8762
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlVar}/apache.conf

validate:
  response_code:
    eq: 200
  response_payload:
    or:
      - contains_all:
          - "<Directory"
          - "</Directory"
      - contains_all:
          - "<VirtualHost"
          - "</VirtualHost"
settings:
  duration: FAST
