id: FIREBASE_CONFIG_EXPOSURE
info:
  name: Firebase Config Exposure
  description: "Attacker can get unauthorized access of Firebase configuration details."
  details: >
    "Firebase Config Exposure refers to the vulnerability where Firebase configuration details, such as API key, authentication domain, database URL, and storage bucket, are exposed due to misconfiguration. Unauthorized access to these details can lead to misuse of the API key, unauthorized access to Firebase services, and potential manipulation of associated data. Addressing this vulnerability promptly is crucial to prevent unauthorized access and protect the security and integrity of Firebase services and associated resources."
  impact: "Exposing Firebase configuration details enables attackers to potentially misuse the API key, gain unauthorized access to Firebase services, and manipulate associated data."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: FIREBASE_CONFIG_EXPOSURE
  severity: LOW
  references:
    - https://github.com/firebase/firebaseui-web/blob/master/demo/public/sample-config.js
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-16
    - CWE-200
  cve:
    - CVE-2020-7765
    - CVE-2021-46743

attributes:
  nature: NON_INTRUSIVE
  plan: STANDARD
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar
  response_payload:
    not_contains:
      - "apiKey"
      - "authDomain"
      - "databaseURL"
      - "storageBucket"

wordLists:
  urlPaths:
    - ${urlVar}
    - ${urlVar}/public/config.js
    - ${urlVar}/config.js

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlPaths}

validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
    not_contains:
      - <html>
      - </html>
    contains_all:
      - "apiKey"
      - "authDomain"
      - "databaseURL"
      - "storageBucket"
