id: NODE_ECSTATIC_DIRECTORY_LISTING
info:
  name: "Node.js Ecstatic Package - Directory Listing"
  description: "Node.js Ecstatic Package - Directory Listing is a vulnerability in the Ecstatic package, used for serving static files in Node.js applications, where an improperly configured server may allow attackers to view a list of files and directories within the server's filesystem. This can occur if directory listing is not disabled or access controls are not properly set. It can expose sensitive files or information about the applicationâ€™s structure, increasing the risk of exploitation. Proper configuration and disabling of directory listing are essential to prevent this issue."
  details: "Node.js Ecstatic Package - Directory Listing occurs when the Ecstatic package is misconfigured to allow the listing of files within a directory. If the server is set to allow directory listing without access control, attackers can view all files and subdirectories within the public directory. This can expose sensitive files, application structures, or configurations that should not be publicly accessible. To mitigate this, directory listing should be disabled, and strict access control policies should be enforced."
  impact: "The impact of Node.js Ecstatic Package - Directory Listing can be significant, as it allows attackers to view the contents of directories that should remain private. This exposure can reveal sensitive files, application configurations, or other valuable information, potentially aiding in further attacks like data breaches or unauthorized access. Attackers may also identify vulnerable files or misconfigurations that can be exploited to compromise the system, leading to security breaches or integrity issues."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: NODE_ECSTATIC_DIRECTORY_LISTING
  severity: MEDIUM
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-16
  cve:
    - CVE-2021-43798

attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
compliance_standards: compliance/security-misconfiguration.conf

api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/img/'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
        - add_header:
            range: 10000
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - "<title>Index of /img/</title>"
strategy:
  run_once: /
