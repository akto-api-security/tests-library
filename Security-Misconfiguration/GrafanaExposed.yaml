id: GRAFANA_EXPOSED
info:
  name: "Grafana Exposed"
  description: >
    "This vulnerability occurs when Grafana instances are accessible without proper authentication or authorization, exposing dashboards and sensitive configuration information."
  details: >
    "Exposed Grafana instances can allow unauthorized users to view and interact with dashboards, potentially leading to the exposure of sensitive data visualizations, database connections, and metrics. This can occur due to misconfigurations in network security settings or when services are inadvertently made publicly accessible."
  impact: >
    "The exposure of Grafana can result in unauthorized access to critical monitoring and logging data. Attackers could gain insights into the system architecture, performance issues, or sensitive business metrics, which could be exploited to perform further attacks or disrupt services."

  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: GRAFANA_EXPOSED
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"

  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300

wordLists:
  filePath:
    - /conf/default.ini
    - /api/frontend/settings
    - /api/admin/settings
    - /grafana/grafana.ini
    - /api/datasources
    - /api/auth/keys
    - /api/environment

execute:
  type: single
  requests:
    - req:
        - modify_url: ${filePath}

validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
    contains_either:
      - metrics
      - apiKey
      - buildInfo
      - grafana
      - prometheus
      - elasticsearch
    not_contains:
      - Error
      - Internal Server
      - Failed
      - Unauthorized
      - access denied
      - Forbidden
      - Method Not allowed
      - Gateway timeout
      - request timeout
      - server error
      - server busy
      - authentication error
      - authorization error
      - validation error
      - Permission Denied
      - invalid token
      - token expired
      - session expired
      - session timeout
      - unexpected error
      - unable to process request
      - bad request
      - service unavailable
      - account is locked
      - account is blocked
      - multiple failed attempts
      - Attention Required!
      - CloudFlare
      - "Sorry, you have been blocked"
      - <html>
      - </html>

strategy:
  run_once: /
