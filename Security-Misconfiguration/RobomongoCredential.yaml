id: ROBOMONGO_CREDENTIAL
info:
  name: MongoDB credential disclosure
  description: "MongoDB credentials file used by RoboMongo"
  details: >
    "The template searches for the presence of MongoDB credentials file (robomongo.json) at the specified URLs. This file contains sensitive information such as the database name, username, password, and server host."
  impact: "The exposure of MongoDB credentials can lead to unauthorized access and manipulation of the database, compromising the confidentiality and integrity of the data stored within."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: ROBOMONGO_CREDENTIAL
  severity: HIGH
  references:
    - https://web.cystack.net/vulnerability/cystack.remote.robomongo_cred_disclosure
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-16
    - CWE-200
  cve:
    - CVE-2023-4009
    - CVE-2021-32039

attributes:
  nature: INTRUSIVE
  plan: STANDARD
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

wordLists:
  urlPaths:
    - ${urlVar}/db/robomongo.json
    - ${urlVar}/robomongo.json

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlPaths}

validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    not_contains:
      - <html>
      - </html>
    contains_all:
      - "databaseName"
      - "userName"
      - "userPassword"
      - "serverHost"
  response_headers:
    for_one:
      value:
        contains_all:
          - "application/json"
