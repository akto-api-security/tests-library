id: CGI_PRINTENV
info:
  name: CGI script environment variable
  description: "A test CGI script on the server leaks a list of server environment variables in the response page."
  details: >
    "CGI Script Environment Variable refers to a vulnerability where a test CGI script on the server unintentionally exposes a list of server environment variables in its response page. These variables may include sensitive information like database paths, SSL configuration, remote IP addresses, and server administrator details. The leakage of such information can provide attackers with valuable insights into the server's configuration, potentially aiding them in planning targeted attacks. Addressing this misconfiguration promptly is crucial to prevent unauthorized access and protect the confidentiality of sensitive information."
  impact: "Exposing server environment variables through the CGI script increases the risk of targeted attacks, unauthorized access, and compromise of sensitive data and system integrity."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: CGI_PRINTENV
  severity: MEDIUM
  references:
    - https://www.acunetix.com/vulnerabilities/web/test-cgi-script-leaking-environment-variables/
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-16
  cve:
    - CVE-2023-22897

attributes:
  nature: NON-INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlVar}/cgi-bin/printenv.pl

validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    not_contains:
      - <html>
      - </html>
    contains_either:
      - 'MYSQL_HOME'
      - 'OPENSSL_CONF'
      - 'REMOTE_ADDR'
      - 'SERVER_ADMIN'
      - 'Environment Variables'
