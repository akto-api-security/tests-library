id: EXPRESS_STACK_TRACE_ENABLED
info:
  name: Express Stack Trace Enabled
  description: Express Stack Trace Enabled Misconfiguration exposes sensitive error details, potentially aiding attackers in identifying vulnerabilities and exploiting the application.
  details: >
    The Express Stack Trace Enabled misconfiguration occurs when detailed error stack traces are returned in response  payloads. These stack traces contain sensitive information about the application's code, such as file paths and  function names. If an attacker gains access to these stack traces, it can significantly aid them in identifying  potential vulnerabilities and crafting targeted attacks. It is crucial to disable stack trace information in  production environments to prevent the exposure of sensitive details and enhance security posture.
  impact: Enabling stack traces in Express responses exposes sensitive code information, assisting attackers in pinpointing vulnerabilities and launching targeted attacks.
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: Server Misconfiguration
  severity: LOW
  tags:
    - ExpressJS
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-209

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlVar}/cy8Ku20LH6V6Yc0q0pJX

validate:
  response_payload:
    contains_all:
      - "NotFoundError: Not Found"
      - "at Function.handle"
