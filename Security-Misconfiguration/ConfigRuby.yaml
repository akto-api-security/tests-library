id: CONFIG_RUBY
info:
  name: Config Ruby File Disclosure
  description: "Config Ruby File Disclosure is a vulnerability where sensitive configuration files in Ruby applications, such as `config/database.yml`, are exposed to unauthorized users. These files often contain credentials, API keys, or sensitive settings that attackers can exploit to gain unauthorized access or escalate privileges. Proper access controls and avoiding exposure of such files in web directories can mitigate this risk."
  details: >
    "Config Ruby File Disclosure refers to the vulnerability where Ruby configuration files, such as config.rb, .chef/config.rb, and assets/config.rb, are exposed due to misconfiguration. Unauthorized access to these files can reveal sensitive information about the application's configuration, including directory paths for images and CSS. Attackers can leverage this information to gain insights into the application's structure, potentially enabling further attacks such as path traversal or unauthorized file access. Promptly addressing this vulnerability is essential to prevent unauthorized access and protect the security and integrity of the application."
  impact: "Enables attackers to gain insights into the application's structure, potentially leading to path traversal or unauthorized file access."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: CONFIG_RUBY
  severity: MEDIUM
  references:
    - https://www.broadcom.com/support/security-center/attacksignatures/detail?asid=31405
    - https://www.acunetix.com/vulnerabilities/web/ruby-on-rails-database-configuration-file/
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-538
  cve:
    - CVE-2019-5418

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

wordLists:
  urlPaths:
    - ${urlVar}/config.rb
    - ${urlVar}/.chef/config.rb
    - ${urlVar}/assets/config.rb

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlPaths}

validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    not_contains:
      - <html>
      - </html>
    contains_all:
      - 'images_dir'
      - 'css_dir'
