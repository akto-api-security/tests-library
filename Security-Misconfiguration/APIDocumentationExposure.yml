id: API_DOCUMENTATION_EXPOSURE
info:
  name: "API Documentation Exposure via auth header manipulation"
  description: "This test refers to the unintended public accessibility of API documentation, which details the endpoints, request/response formats, and authentication methods of an application's APIs. When exposed without proper security controls, this documentation can provide attackers with critical insights into the API's functionality and structure. Such exposure increases the risk of targeted attacks, as attackers can identify potential vulnerabilities to exploit."
  details: "API Documentation Exposure occurs when the UI or JSON file is accessible to the public without adequate security measures, allowing unauthorized users to view detailed API specifications. This can include information about available endpoints, parameters, response types, and security protocols, making it easier for attackers to understand the application's architecture. The exposed documentation can facilitate targeted attacks, such as injection or exploitation of vulnerabilities. To protect against this exposure, organizations should implement strong access controls, secure the documentation behind authentication, and limit visibility to trusted users only."
  impact: "The impact of API Documentation Exposure can be significant, as it provides attackers with detailed knowledge of the API's structure and functionality, making it easier to exploit vulnerabilities. This can lead to unauthorized access to sensitive data, manipulation of application behavior, and potential data breaches. Additionally, the exposure can result in targeted attacks, such as denial of service or injection attacks, causing operational disruptions and financial losses. Furthermore, organizations may face reputational damage and regulatory consequences if sensitive information is compromised due to insufficient security measures."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: API_DOCUMENTATION_EXPOSURE
  severity: MEDIUM
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-16
  cve:
    - CVE-2021-43798

attributes:
  nature: NON_INTRUSIVE
  plan: STANDARD
  duration: FAST


api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0

execute:
  type: single
  requests:
    - req:
        - replace_auth_header: true

validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_either:
      - "API Documentation"
