id: DRUPAL_FULL_PATH_DISCLOSURE
info:
  name: "Drupal Full Path Disclosure"
  description: "Drupal Full Path Disclosure is a vulnerability in the Drupal content management system that reveals the full file system path of the application or server when an error occurs. This can happen when Drupal's error messages or logs display sensitive information about the server's directory structure. By exposing this information, attackers can gain insight into the server's internal structure, potentially making it easier to exploit other vulnerabilities or gain unauthorized access. To mitigate this risk, it is crucial to configure error handling securely and ensure sensitive information is not exposed in error messages or logs."
  details: "The Drupal Full Path Disclosure vulnerability occurs when error messages in Drupal reveal the full file path of the application or server, such as the directory structure and filenames. This can happen if Drupal is not configured to suppress detailed error messages in a production environment. Attackers can use this exposed information to infer the structure of the underlying system, which could help in locating other vulnerabilities or exploiting misconfigurations. Securing error handling by disabling detailed error messages and using generic error pages can help prevent this information leakage."
  impact: "The impact of a Drupal Full Path Disclosure vulnerability is significant, as it exposes sensitive information about the server's internal file system structure. Attackers can use this information to map out the applicationâ€™s architecture and identify potential targets for further exploitation, such as misconfigurations or unpatched vulnerabilities. This could lead to unauthorized access, privilege escalation, or data compromise. Proper error handling and disabling detailed error messages in production environments are crucial to mitigating this risk and safeguarding the system."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: DRUPAL_FULL_PATH_DISCLOSURE
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


settings:
  nature: NON-INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/core/authorize.php'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - "getHashSalt"
      - "RuntimeException"
strategy:
  run_once: /
