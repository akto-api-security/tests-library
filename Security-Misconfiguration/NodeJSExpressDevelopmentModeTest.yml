id: NODEJS_EXPRESS_DEV_ENV
info:
  name: "Node.js Express NODE_ENV Development Mode Enabled Test"
  description: "Node.js Express NODE_ENV Development Mode Enabled Test checks whether an Express application is running with the `NODE_ENV` environment variable set to `development` in a production environment. In development mode, additional debugging information and error stack traces are exposed, which can reveal sensitive implementation details. This configuration is intended for local development and can pose significant security risks if enabled in production."
  details: "Node.js Express NODE_ENV Development Mode Enabled Test involves verifying if the `NODE_ENV` environment variable is mistakenly set to `development` in a production environment. When in development mode, Express applications may display detailed error messages, stack traces, and internal debugging information that should be kept hidden in a production setting. This can expose valuable application logic, potential vulnerabilities, and sensitive data, increasing the risk of exploitation by attackers. Proper environment configuration is critical to avoid such risks."
  impact: "The impact of having NODE_ENV Development Mode Enabled in a Node.js Express application in production can be severe, as it exposes sensitive debugging information, error stack traces, and internal configurations. Attackers can exploit this information to understand the application's inner workings, identify vulnerabilities, and potentially bypass security mechanisms. This can lead to data breaches, unauthorized access, and exploitation of the application, severely compromising the overall security and integrity of the system."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: NODEJS_EXPRESS_DEV_ENV
  severity: MEDIUM
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-16
  cve:
    - CVE-2021-43798

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
execute:
  type: multiple
  requests:
    - req:
        - modify_url: "/"
        - modify_method: GET
        - replace_body: '{}'
        - validate:
            response_headers:
              for_one:
                key:
                  eq: "x-powered-by"
                value:
                  eq: "express"
        - success: x2
        - failure: exit
    - req:
        - modify_url: "/"
        - modify_method: GET
        - replace_body: 't'
        - validate:
            response_code:
              eq: 400
            response_payload:
              contains_either: 'SyntaxError: Unexpected token'
            response_headers:
              for_one:
                key:
                  eq: "x-powered-by"
                value:
                  eq: "express"
        - success: vulnerable
        - failure: exit
strategy:
  run_once: /
