id: ORACLE_EBS_CREDENTIALS
info:
  name: Oracle EBS Credentials Disclosure
  description: "Oracle EBS credentials may be exposed through the jtfwrepo.xml file."
  details: >
              "The jtfwrepo.xml file in Oracle EBS may contain sensitive information such as passwords and user lists, making it a potential security risk if accessed by unauthorized individuals."
  impact: "Exposing Oracle EBS credentials can lead to unauthorized access and compromise of sensitive data stored in the system."
  remediation: "To address Oracle EBS credentials disclosure, implement strict credential management practices, storing credentials encrypted and restricting access to authorized personnel. Utilize the principle of least privilege when assigning roles and permissions within Oracle EBS, ensuring users have access only to necessary resources. Establish robust audit trails to monitor and track access to sensitive data and credentials, and conduct regular reviews to detect and remediate any unauthorized access or disclosures. These measures collectively enhance the security of Oracle EBS and reduce the risk of credentials exposure."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: ORACLE_EBS_CREDENTIALS
  severity: MEDIUM
  references:
    - https://www.blackhat.com/docs/us-16/materials/us-16-Litchfield-Hackproofing-Oracle-eBusiness-Suite-wp-4.pdf
    - https://www.blackhat.com/docs/us-16/materials/us-16-Litchfield-Hackproofing-Oracle-eBusiness-Suite.pdf
    - http://www.davidlitchfield.com/AssessingOraclee-BusinessSuite11i.pdf
  cwe:
    - CWE-16
    - CWE-200
  cve:
    - CVE-2023-21849
    - CVE-2023-21847

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar
  
execute:
  type: single
  requests:
    - req:
      - modify_url: ${urlVar}/OA_HTML/jtfwrepo.xml

validate:
  response_code:
    eq: 200
  response_payload:
    contains_all:
      - "password"
      - "<PUSR_LIST>"
  response_headers:
    for_one:
      value:
        contains_all:
          - "text/xml"