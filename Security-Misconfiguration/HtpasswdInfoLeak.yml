id: HTPASSWD_INFO_LEAK
info:
  name: "Htpasswd Information Leak"
  description: The '.htpasswd' file or related htaccess configuration files can be exposed due to improper server configurations. This file may contain sensitive information such as hashed passwords for user authentication.
  details: The '.htpasswd' file is a part of the Apache server configuration used for basic authentication. If improperly protected, attackers can directly access this file through the web server, potentially allowing them to acquire  user credentials (hashed passwords) and target further attacks by cracking  the hashes or launching brute force attacks.
  impact: Unauthorized access to sensitive authentication credentials. Increased risk of password cracking or brute-force attacks. Compromised user accounts and potential data breaches. Reputation damage and regulatory penalties.

  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: HTPASSWD_INFO_LEAK
  severity: LOW
  references:
    - https://hackerone.com/reports/219197
    - https://cwe.mitre.org/data/definitions/200.html
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
    - 45 CFR ยง 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300

execute:
  type: single
  requests:
    - req:
        - modify_url: /.htpasswd

validate:
  response_code:
    gte: 200
    lt: 300
  response_headers:
    for_one:
      key:
        eq: content-type
      value:
        not_contains:
          - xml
          - json
          - html

strategy:
  run_once: /
settings:
  duration: FAST
