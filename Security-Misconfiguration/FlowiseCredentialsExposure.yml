id: FLOWISE_CREDENTIALS_EXPOSURE
info:
  name: "Flowise Credentials Exposure Test"
  description: "The Flowise Credentials Exposure Test checks for vulnerabilities in the Flowise application that may lead to the exposure of sensitive credentials, such as API keys, usernames, or passwords. This can occur when credentials are stored or transmitted insecurely, such as in plaintext or without proper encryption. If exploited, attackers could gain unauthorized access to internal systems or services. To mitigate this risk, Flowise should implement secure storage practices, encryption, and proper access control mechanisms for credentials."
  details: "The Flowise Credentials Exposure Test involves identifying instances where sensitive credentials, such as API keys or passwords, may be improperly handled within the Flowise application. This vulnerability could arise from credentials being stored in plaintext, hardcoded within source code, or transmitted over unencrypted channels. If attackers gain access to exposed credentials, they could exploit them to access sensitive systems, services, or data. To mitigate such risks, Flowise should ensure secure credential storage (e.g., using environment variables or a secrets management service) and enforce encryption for data in transit."
  impact: "The impact of a Flowise Credentials Exposure vulnerability is high, as it could allow attackers to gain unauthorized access to critical systems or services by exploiting exposed API keys, passwords, or other sensitive credentials. This could lead to data breaches, service disruptions, or further compromise of internal infrastructure. In the worst case, attackers could escalate their access, causing significant damage or loss of sensitive information. To prevent this, proper encryption, secure storage, and access control measures must be implemented for all credentials."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: FLOWISE_CREDENTIALS_EXPOSURE
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


attributes:
  nature: NON_INTRUSIVE
  plan: PRO
  duration: FAST
compliance_standards: compliance/security-misconfiguration.conf

api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
  url:
    extract: urlVar
wordLists:
  paths:
    - '/API/V1/credentials'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - credentialName
      - updatedDate
strategy:
  run_once: /
