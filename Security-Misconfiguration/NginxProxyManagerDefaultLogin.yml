id: NGINX_PROXY_MGR_DEFAULT_LOGIN
info:
  name: "Nginx Proxy Manager Default Login Test"
  description: "The Nginx Proxy Manager Default Login Test involves checking if the default login credentials for the Nginx Proxy Manager interface are still active and accessible. Nginx Proxy Manager is a web-based tool for managing Nginx reverse proxies, and leaving default credentials unchanged can lead to unauthorized access. Attackers can exploit this by attempting to log in using the default username and password, potentially compromising the server configuration. It is crucial to change default credentials during setup to enhance security."
  details: "The Nginx Proxy Manager Default Login Test checks whether the default login credentials (often 'admin' for both the username and password) are still in use on an Nginx Proxy Manager instance. If these default credentials are not changed, attackers can easily gain unauthorized access to the management interface, allowing them to modify proxy settings, manage SSL certificates, or potentially compromise the server. Proper security practices include changing the default credentials immediately after installation and securing the management interface with strong passwords or additional access controls."
  impact: "The impact of the Nginx Proxy Manager Default Login vulnerability is significant, as leaving default login credentials unchanged allows attackers to gain unauthorized access to the management interface. This could lead to the manipulation of reverse proxy configurations, exposure of sensitive data, or even complete server compromise. Attackers could disrupt services, escalate privileges, or exploit other vulnerabilities within the system. Ensuring default credentials are changed and implementing strong access controls are essential to prevent these risks."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: NGINX_PROXY_MGR_DEFAULT_LOGIN
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


settings:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/api/tokens'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: POST
        - replace_body: '{"identity": "admin@example.com","secret": "changeme"}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_either:
      - '{\"token", "expires\":'
  response_headers:
    for_one:
      key:
        eq: "content-type"
      value:
        eq: "application/json"
strategy:
  run_once: /
