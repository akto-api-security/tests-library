id: GRADLE_LIBRARY_VERSION_DISCLOSURE
info:
  name: "Gradle Library Version Disclosure"
  description: "Gradle Library Version Disclosure refers to the exposure of the versions of libraries or dependencies used in a Gradle-based project. This can occur through misconfigured build scripts, public repositories, or error messages that reveal the exact versions of libraries in use. Attackers can exploit this information to identify vulnerabilities tied to specific library versions, enabling targeted attacks. Preventing such disclosure involves securing build scripts, using obfuscation techniques, and managing dependencies securely."
  details: "Gradle Library Version Disclosure occurs when the versions of libraries and dependencies used in a Gradle-based project are unintentionally exposed. This can happen through publicly accessible build files (e.g., `build.gradle`), error messages, or metadata files that disclose version information. Attackers can exploit this by searching for known vulnerabilities associated with specific versions of libraries, making the system more susceptible to exploits. To mitigate this, sensitive information in build files should be protected, and dependency management should be handled securely."
  impact: "The impact of Gradle Library Version Disclosure can be severe, as it exposes specific versions of libraries that may have known security vulnerabilities. Attackers can use this information to target vulnerabilities in those libraries, potentially compromising the application or system. It can lead to exploitation of outdated or unpatched dependencies, escalating the risk of data breaches, code injection, or other attacks. Proper version obfuscation and dependency management practices are essential to minimize this risk."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: GRADLE_LIBRARY_VERSION_DISCLOSURE
  severity: LOW
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-213
  cve:
    - CVE-2018-10245


settings:
  nature: NON-INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/gradle/libs.versions.toml'
    - '/libs.versions.toml'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - "[versions]"
      - "[libraries]"
      - "[bundles]"
strategy:
  run_once: /
