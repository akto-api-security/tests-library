id: NPM_SHRINKWRAP_EXPOSURE
info:
  name: "NPM ShrinkWrap Exposure"
  description: "NPM Shrinkwrap Exposure refers to the unintentional inclusion of sensitive information or development dependencies in the `npm-shrinkwrap.json` file, used to lock package versions in a Node.js project. If this file is misconfigured or publicly exposed, it can reveal internal dependencies, package metadata, or even critical details like private repository URLs. This exposure can aid attackers in identifying vulnerabilities or gaining unauthorized access."
  details: "NPM Shrinkwrap Exposure occurs when the `npm-shrinkwrap.json` file, intended to lock dependency versions, is improperly managed or publicly exposed. This file may contain development dependencies, internal package details, or private repository links that can inadvertently reveal sensitive information. Attackers can use this data to analyze dependencies for vulnerabilities, exploit misconfigurations, or target exposed internal systems, compromising the application's security posture."
  impact: "The impact of NPM Shrinkwrap Exposure includes leaking sensitive information such as private repository URLs, internal dependency details, or metadata about the applicationâ€™s build environment. This can enable attackers to identify exploitable vulnerabilities in dependencies or gain unauthorized access to internal systems. Such exposure can lead to security breaches, intellectual property theft, and increased risk of supply chain attacks."
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: NPM_SHRINKWRAP_EXPOSURE
  severity: MEDIUM
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md"
  cwe:
    - CWE-200
    - CWE-16
  cve:
    - CVE-2021-43798

settings:
  nature: NON-INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
  url:
    extract: urlVar
execute:
  type: single
  requests:
    - req:
        - modify_method: GET
        - modify_url: "/npm-shrinkwrap.json"
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    contains_all:
      - version
      - dependencies
    length:
      gt: 0
    not_contains:
      - <html>
      - </html>
  response_headers:
    for_one:
      key:
        eq: "content-type"
      value:
        eq: "application/json"
