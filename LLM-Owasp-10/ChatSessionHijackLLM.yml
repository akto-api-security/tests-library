id: CHAT_SESSION_HIJACK_LLM
info:
  name: Chat Retrieval without Session Binding (BOLA)
  description: 'This test checks if chat history can be accessed using a valid chat_id
    but without verifying user-session ownership.

    '
  details: 'In this vulnerability scenario, an authenticated user may be able to access
    chat sessions that belong to other users simply by supplying a valid `chat_id`,
    even though the session is not bound to the requesting user''s identity or session
    token.


    This indicates a lack of proper authorization checks tied to session ownership
    and object-level access control.

    '
  impact: 'Exploiting this vulnerability can allow attackers to read private conversations
    of other users, potentially exposing PII, sensitive internal data, or business
    conversations, leading to major privacy breaches and compliance issues.

    '
  category:
    name: BOLA
    shortName: BOLA
    displayName: Broken Object Level Authorization (BOLA)
  subCategory: CHAT_SESSION_HIJACK_LLM
  severity: HIGH
  tags:
  - Broken Auth
  - Session Hijack
  - Privacy Risk
  - OWASP Top 10
  references:
  - https://owasp.org/API-Security/editions/2023/en/0xa1-broken-object-level-authorization/
  - https://portswigger.net/web-security/access-control/object-level
  cwe:
  - CWE-639
attributes:
  nature: NON_INTRUSIVE
  plan: FREE
  duration: FAST
wordLists:
  AUTH_COOKIE:
  - sessionidstage=zmq0exasea7h6ymv53eevtd0058eldhk
api_selection_filters:
  query_param:
    for_one:
      key:
        contains_either: chat_id
execute:
  type: single
  requests:
  - req:
    - modify_header:
        cookie: ${AUTH_COOKIE}
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    percentage_match:
      gt: 80
    length:
      gt: 0
    not_contains:
    - Error
    - Internal Server
    - Failed
    - Unauthorized
    - access denied
    - Forbidden
    - Method Not allowed
    - Gateway timeout
    - request timeout
    - server error
    - server busy
    - authentication error
    - authorization error
    - validation error
    - Permission Denied
    - invalid token
    - token expired
    - session expired
    - session timeout
    - unexpected error
    - unable to process request
    - bad request
    - service unavailable
    - account is locked
    - account is blocked
    - multiple failed attempts
