id: EncodingAbuse
filter:
 - or:
    - request_headers:
        for_one:
          key:
            contains_either:
              - "X-Transfer-Encoding"
              - "X-Content-Encoding"
    - request_headers:
        for_one:
          key:
            eq: "transfer-encoding"
          value:
            contains_all:
              - chunked
              - gzip
              - deflate
    - request_headers:
        for_one:
          key:
            eq: "content-encoding"
          value:
            contains_all:
              - compress
              - gzip
              - deflate
    - request_headers:
        for_one:
          key:
            eq: "content-transfer-encoding"
          value:
            contains_all:
              - base64
              - quoted-printable
              - binary
    - request_headers:
        for_one:
          key:
            eq: "transfer-encoding"
          value:
            contains_all:
              - chunked
              - gzip
              - deflate
              - trailers
info:
  name: "EncodingAbuse"
  description: "EncodingAbuse is a runtime threat where attackers manipulate data encoding (e.g., Base64, URL encoding, or Unicode transformations) to bypass security filters and exploit API vulnerabilities. This can lead to WAF evasion, input validation bypass, or injection attacks. Effective runtime protection involves detecting anomalous encoding patterns and normalizing inputs before processing."
  details: "EncodingAbuse occurs when attackers encode payloads to evade security mechanisms like WAFs, input validation, or logging systems. Common techniques include double encoding, mixed encoding (e.g., Base64 within URL encoding), and Unicode obfuscation. APIs processing user inputs without proper decoding and normalization are vulnerable, potentially leading to injection attacks, privilege escalation, or data exfiltration."
  impact: "EncodingAbuse can bypass security controls, allowing attackers to inject malicious payloads undetected. This can lead to API abuse, data breaches, authentication bypass, or command execution. If not mitigated, it increases the risk of evasion-based attacks, making threat detection and logging less effective."
  category:
    name: "SM"
    displayName: "SM"
  subCategory: "SM"
  severity: MEDIUM

aggregation_rules:
  - rule:
      name: "Rule 1"
      condition:
        matchCount: 50 
        windowThreshold: 5
  - rule:
      name: "Rule 2"
      condition:
        matchCount: 100 
        windowThreshold: 10