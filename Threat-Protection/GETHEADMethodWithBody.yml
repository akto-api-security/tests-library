id: GETHEADMethodWithBody
filter:
  method:
    contains_either:
      - GET
      - HEAD
  request_payload:
    for_one:
      key:
        regex: .*
      value:
        regex: .*
info:
  name: "GETHEADMethodWithBody"
  description: "GETHEADMethodWithBody is a runtime threat protection rule that detects HTTP `GET` or `HEAD` requests with a request body. Since these methods are not meant to include a body, such requests can indicate misuse or potential attack attempts, like smuggling payloads past security controls. Blocking such requests helps prevent API abuse and security vulnerabilities."
  details: "GETHEADMethodWithBody is a security rule in runtime threat protection that identifies HTTP `GET` or `HEAD` requests containing a request body. These methods are typically designed to be bodyless, so their misuse may indicate an anomaly or attack attempt, such as request smuggling or evasion techniques. Enforcing this rule helps maintain API security by blocking unexpected payloads."
  impact: "Allowing HTTP `GET` or `HEAD` requests with a body can lead to security risks like request smuggling, cache poisoning, and API misuse. Attackers may exploit this to bypass security controls, inject malicious payloads, or manipulate API behavior. Enforcing this rule helps prevent such threats, ensuring API integrity and resilience against abuse."
  category:
    name: "SM"
    displayName: "SM"
  subCategory: "SM"
  severity: MEDIUM

aggregation_rules:
  - rule:
      name: "Rule 1"
      condition:
        matchCount: 50 
        windowThreshold: 5
  - rule:
      name: "Rule 2"
      condition:
        matchCount: 100 
        windowThreshold: 10