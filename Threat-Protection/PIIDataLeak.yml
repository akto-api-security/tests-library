id: PIIDataLeak 
filter:
  or:
    - response_payload:
        regex:
          - \b((?!000|666|9\d{2})(?:[0-8]\d{2}|7[0-6]\d)[- ]?(?!00)\d{2}[- ]?(?!0000)\d{4}|(?:4\d{3}|5[1-5]\d{2}|3[47]\d{2}|6(?:011|5\d{2})|(?:2131|1800|35\d{3}))([- ]?)\d{4}\2\d{4}\2\d{1,4})\b
    - response_payload:
        regex:
          - \b(\d{4}[- ]?\d{4}[- ]?\d{4}|[A-Z]{5}[0-9]{4}[A-Z])\b

info:
  name: "PIIDataLeak"
  description: "PII Data Leak refers to the accidental or unauthorized exposure of Personally Identifiable Information through logs, APIs, misconfigured systems, or insecure data handling practices. Such leaks can occur due to improper data masking, verbose error messages, exposed endpoints, or insecure storage."
  details: "PII leaks commonly stem from insecure logging, improperly secured APIs, misconfigured cloud buckets, or data inadvertently exposed in URLs, headers, or request/response bodies. Examples include Aadhaar numbers in logs, credit card numbers in query params, or SSNs in error traces. Prevention involves data classification, redaction/masking, input validation, and restricting data flow through sensitive components."
  impact: "Exposed PII can lead to identity theft, financial fraud, regulatory violations (e.g., GDPR, HIPAA), and reputational harm. Attackers may exploit leaked data to conduct phishing attacks, impersonate users, or gain deeper access into systems. Organizations may face penalties, lawsuits, and loss of user trust."
  category:
    name: "PIIDataLeak"
    displayName: "PIIDataLeak"
  subCategory: "PIIDataLeak"
  severity: MEDIUM
