id: XSS
filter:
  or:
    - request_payload:
        regex:
          - "(?i)(?:<(?!a\s|link\s|meta\s|style\s)|%3[cC]|&#x0*3[cC];|&#0*60;)(?:script|iframe|object|embed)(?:[^>]{0,200}?\s+on[a-z0-9._-]{2,30}\s*=(?!["\']?(?:pndoCacheClear\(\)|javascript:void\(0\)|javascript:;)["\']?)|[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:))|<\s*(?:script(?![^>]*\btype\s*=\s*["\']application/)|iframe[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:)|object|embed)\b[^>]*>|style\s*=\s*["\'][^"'>]*\b(?:expression|behavior\s*:|url\s*\(\s*["\']?javascript:)|<\s*style\b[^>]*\b(?:expression|url\s*\(\s*["\']?javascript:)|<script[^>]*\bsrc\s*=\s*["\']?data:|\b(?:href|src)\s*=\s*["\']?data:text/html|(?:alert|prompt|confirm|eval)\s*\([^)]*(?:document\.|location\.|cookie)|document\.(?:cookie|write)|(?:&#x0*3c;|&#0*60;)(?:script|iframe)"
    - query_param:
        regex:
          - "(?i)(?:<(?!a\s|link\s|meta\s|style\s)|%3[cC]|&#x0*3[cC];|&#0*60;)(?:script|iframe|object|embed)(?:[^>]{0,200}?\s+on[a-z0-9._-]{2,30}\s*=(?!["\']?(?:pndoCacheClear\(\)|javascript:void\(0\)|javascript:;)["\']?)|[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:))|<\s*(?:script(?![^>]*\btype\s*=\s*["\']application/)|iframe[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:)|object|embed)\b[^>]*>|style\s*=\s*["\'][^"'>]*\b(?:expression|behavior\s*:|url\s*\(\s*["\']?javascript:)|<\s*style\b[^>]*\b(?:expression|url\s*\(\s*["\']?javascript:)|<script[^>]*\bsrc\s*=\s*["\']?data:|\b(?:href|src)\s*=\s*["\']?data:text/html|(?:alert|prompt|confirm|eval)\s*\([^)]*(?:document\.|location\.|cookie)|document\.(?:cookie|write)|(?:&#x0*3c;|&#0*60;)(?:script|iframe)"
    - request_headers:
        regex:
          - "(?i)(?:<(?!a\s|link\s|meta\s|style\s)|%3[cC]|&#x0*3[cC];|&#0*60;)(?:script|iframe|object|embed)(?:[^>]{0,200}?\s+on[a-z0-9._-]{2,30}\s*=(?!["\']?(?:pndoCacheClear\(\)|javascript:void\(0\)|javascript:;)["\']?)|[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:))|<\s*(?:script(?![^>]*\btype\s*=\s*["\']application/)|iframe[^>]*\bsrc\s*=\s*["\']?(?:data:|javascript:)|object|embed)\b[^>]*>|style\s*=\s*["\'][^"'>]*\b(?:expression|behavior\s*:|url\s*\(\s*["\']?javascript:)|<\s*style\b[^>]*\b(?:expression|url\s*\(\s*["\']?javascript:)|<script[^>]*\bsrc\s*=\s*["\']?data:|\b(?:href|src)\s*=\s*["\']?data:text/html|(?:alert|prompt|confirm|eval)\s*\([^)]*(?:document\.|location\.|cookie)|document\.(?:cookie|write)|(?:&#x0*3c;|&#0*60;)(?:script|iframe)"

info:
  name: "XSS"
  description: "Cross-Site Scripting (XSS) in API threat protection at runtime involves detecting and blocking malicious scripts injected into API requests or responses. Attackers exploit input validation flaws to execute scripts in a user's browser, leading to data theft or session hijacking. Real-time protection includes input sanitization, content security policies, and behavior-based anomaly detection to prevent script execution"
  details: "XSS in API threat protection at runtime focuses on detecting and preventing malicious script injections in API requests and responses. Attackers exploit insufficient input validation to execute scripts, leading to data leaks or account compromise. Mitigation involves sanitizing inputs, enforcing strict content security policies, and using runtime monitoring to detect anomalies and block malicious payloads."
  impact: "XSS in APIs can lead to session hijacking, data exfiltration, and unauthorized actions on behalf of users. Attackers can steal sensitive information, deface applications, or spread malware. If exploited in critical APIs, it can compromise user trust, violate compliance standards, and cause financial or reputational damage to organizations."
  category:
    name: "XSS"
    displayName: "XSS"
  subCategory: "XSS"
  severity: MEDIUM
