id: BlockedHTTPMethods
filter:
  method:
    contains_either:
      - TRACE
      - TRACK
      - HEAD
      - CONNECT                
    length:
      gt: 0

info:
  name: "BlockedHTTPMethods"
  description: "Blocked HTTP Methods in runtime threat protection for APIs prevent the use of specific HTTP methods (e.g., `TRACE`, `TRACK`, or `HEAD`) to mitigate security risks. Attackers may exploit these methods for unauthorized access, data tampering, or reconnaissance. Blocking unused or risky methods helps reduce the attack surface and enforce API security policies."
  details: "Blocking specific HTTP methods in runtime threat protection helps prevent unauthorized actions like modifying or deleting data. Methods such as `TRACE`, `TRACK`, and `HEAD` can be misused for attacks like Cross-Site Tracing (XST) or unintended data manipulation. Security policies can restrict these methods based on API requirements, reducing potential attack vectors. This enhances API security by allowing only necessary HTTP methods for safe operation."
  impact: "Blocking risky HTTP methods reduces the attack surface, preventing threats like unauthorized data modification, server-side request forgery (SSRF), and reconnaissance attacks. It enhances API security by enforcing strict access controls, minimizing the risk of exploitation. However, improper blocking may disrupt legitimate API functionality, so careful configuration is essential."
  category:
    name: "SM"
    displayName: "SM"
  subCategory: "SM"
  severity: MEDIUM

aggregation_rules:
  - rule:
      name: "Rule 1"
      condition:
        matchCount: 50 
        windowThreshold: 5
  - rule:
      name: "Rule 2"
      condition:
        matchCount: 100 
        windowThreshold: 10