id: MaliciousFileExtensions
filter:
  - or:
      - url:
          contains_either:
            - .exe
            - .sql
            - .dll
            - .bat
      - request_payload:
          for_one:
            key:
              regex: .*
            value:
              contains_either:
                - .exe
                - .sql
                - .dll 
                - .bat
      - query_param:
          for_one:
            key:
              regex: .*
            value:
              contains_either:
                - .exe
                - .sql
                - .dll 
                - .bat        

info:
  name: "MaliciousFileExtensions"
  description: "MaliciousFileExtensions in runtime threat protection for APIs detects and blocks requests containing files with potentially harmful extensions (e.g., `.exe`, `.bat`). Attackers may use such files for malware distribution, command execution, or exploiting vulnerabilities. This protection helps prevent unauthorized code execution and ensures secure API interactions."
  details: "MaliciousFileExtensions protection works by inspecting file uploads in API requests and blocking those with risky extensions commonly used in attacks. It helps prevent malware execution, unauthorized scripts, and other exploits by enforcing strict file-type controls. Organizations can customize allowed extensions based on security policies to reduce attack surface and mitigate threats."
  impact: "Blocking MaliciousFileExtensions reduces the risk of malware infections, remote code execution, and data breaches through API file uploads. It helps protect backend systems from unauthorized script execution and exploits. Without this protection, attackers could upload harmful files, leading to compromised security and operational disruptions."
  category:
    name: "SM"
    displayName: "SM"
  subCategory: "SM"
  severity: MEDIUM

aggregation_rules:
  - rule:
      name: "Rule 1"
      condition:
        matchCount: 50 
        windowThreshold: 5
  - rule:
      name: "Rule 2"
      condition:
        matchCount: 100 
        windowThreshold: 10