id: INVALID_SSN_TEST
info:
  name: "Testing for Invalid SSN"
  description: "Testing vulnerability by injecting various malicious inputs for SSN to check if the application handles them securely."
  details: >
    "This security test aims to identify vulnerabilities related to handling invalid SSN inputs in the API. By injecting different types of invalid SSN values, we test the application's ability to handle and reject these inputs securely, preventing potential exploitation by attackers."
  impact: "An attacker successfully creating or updating an entity with an invalid SSN could lead to data integrity issues and potential vulnerabilities in the system."
  category:
    name: API Security
    shortName: API_SEC
    displayName: API Security Testing
  subCategory: INVALID_SSN
  severity: HIGH
  tags:
    - API Security
    - Data Integrity
  


api_selection_filters:
  query_param:
    for_one:
      key:
        regex: .*UPI_ID.*
        extract: upi_id_key
      value:
        extract: upi_id_value
    request_headers:
      for_one:
      key:
        contains_either: ssn
        extract: ssn_key
      value:
        extract: ssn_value
    


ssnLists:
  ssn_values: 
    - $
    - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Integer vehicula maximus tortor, vel finibus mi. Maecenas egestas justo vel sagittis vulputate. Sed ac odio eu odio elementum cursus. Vivamus pretium vel elit at ultricies. Vivamus rhoncus ultrices urna, id suscipit nulla sagittis eu. Quisque egestas vulputate odio. Curabitur cursus mi nec massa venenatis, vitae volutpat turpis suscipit. Duis aliquet hendrerit massa, a malesuada felis dignissim ac.
    - " "
    - 111-11-1111
    - -69
    - 9223372036854775807
    - 0
    - NULL
    
    
execute:
  type: single
  requests:
    - req:
      - modify_header:
          ssn_key:  ${ssn_values}  

validate:
  response_code:
    gte: 200
    lt: 300
   