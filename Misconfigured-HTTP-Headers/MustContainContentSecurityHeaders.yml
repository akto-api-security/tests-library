id: MUST_CONTAIN_CONTENT_SEC_RESPONSE_HEADERS
info:
  name: Missing Content & Framing Security Response Headers
  description: "The response does not contain some Content & Framing Security security headers."
  details: >
    "These headers prevent untrusted scripts, styles, or content from executing in your pages. They stop MIME type sniffing and block your pages from being embedded in iframes. This helps reduce attack vectors like XSS and clickjacking."
  impact: "Blocks XSS, clickjacking, and content injection attacks."
  category:
    name: MHH
    shortName: Misconfigured HTTP Headers
    displayName: Misconfigured HTTP Headers (MHH)
  subCategory: MUST_CONTAIN_RESPONSE_HEADERS
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://web.dev/security-headers/"
    - "https://www.keycdn.com/blog/http-security-headers"
    - "https://www.invicti.com/white-papers/whitepaper-http-security-headers"
  cwe:
    - CWE-693
  cve:
    - CVE-2022-41915
    - CVE-2022-37436

attributes:
  nature: INTRUSIVE
  plan: STANDARD
  duration: FAST


api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    neq: "OPTIONS"
execute:
  type: single
  requests:
    - req: []

validate:
  response_code:
    gte: 200
    lt: 300
  response_headers:
    for_one:
      key:
        not_contains:
          - Content-Security-Policy
          - X-Content-Type-Options
          - X-Frame-Options
          - X-Permitted-Cross-Domain-Policies
strategy:
  run_once: /
