id: UNWANTED_RESPONSE_HEADERS
info:
  name: Unwanted Response Headers
  description: "The response contains headers which might leak sensitive information."
  details: >
    "Some headers contain data pertaining to server information like server version or details about  hosting and deployment. This data makes your site easier to attack. Some other headers can also be  used to override the default behaviour of the application and give debug information or skip  authentication."
  impact: "This information can be used to facilitate more sophisticated attacks on your application."
  category:
    name: MHH
    shortName: Misconfigured HTTP Headers
    displayName: Misconfigured HTTP Headers (MHH)
  subCategory: UNWANTED_RESPONSE_HEADERS
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://www.fastly.com/blog/headers-we-dont-want"
    - "https://portswigger.net/web-security/host-header/exploiting"
    - "https://blog.yeswehack.com/yeswerhackers/http-header-exploitation/"
  cwe:
    - CWE-16
    - CWE-200
  cve:
    - CVE-2022-3215
    - CVE-2020-5247
    - CVE-2023-38039

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
    - Article 25
  HIPAA:
    - 45 CFR ยง 164.312(c)(1)
    - 45 CFR ยง 164.312(e)(1)
  SOC 2:
    - System and Communication Security
    - Secure Application Development Controls
  PCI DSS:
    - Requirement 6.5.10
    - Requirement 4.1
  ISO 27001:
    - A.13.1.1
    - A.14.2.5
  NIST 800-53:
    - SC-12
    - SC-13
  CSA CCM:
    - IVS-09
    - TVM-03
  CIS Controls:
    - IG1 Safeguard 14.4
    - IG2 Safeguard 9.2
  FedRAMP:
    - SC-12
    - SC-13
  NIST 800-171:
    - 3.13.1
    - 3.13.8
  FISMA:
    - SC-12
    - SC-13
  Cybersecurity Maturity Model Certification (CMMC):
    - SC.1.175
    - SC.3.192
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    neq: "OPTIONS"
execute:
  type: single
  requests:
    - req: []

validate:
  response_code:
    gte: 200
    lt: 300
  response_headers:
    for_one:
      key:
        contains_either:
          - "$wsep"
          - "Host-Header"
          - "K-Proxy-Request"
          - "Liferay-Portal"
          - "Pega-Host"
          - "Powered-By"
          - "Product"
          - "Server"
          - "SourceMap"
          - "X-AspNet-Version"
          - "X-AspNetMvc-Version"
          - "X-Atmosphere-error"
          - "X-Atmosphere-first-request"
          - "X-Atmosphere-tracking-id"
          - "X-B3-ParentSpanId"
          - "X-B3-Sampled"
          - "X-B3-SpanId"
          - "X-B3-TraceId"
          - "X-CF-Powered-By"
          - "X-CMS"
          - "X-Content-Encoded-By"
          - "X-Envoy-Attempt-Count"
          - "X-Envoy-External-Address"
          - "X-Envoy-Internal"
          - "X-Envoy-Original-Dst-Host"
          - "X-Envoy-Upstream-Service-Time"
          - "X-Framework"
          - "X-Generated-By"
          - "X-Generator"
          - "X-Mod-Pagespeed"
          - "X-Old-Content-Length"
          - "X-Page-Speed"
          - "X-Php-Version"
          - "X-Powered-By"
          - "X-Powered-By-Plesk"
          - "X-Powered-CMS"
          - "X-Redirect-By"
          - "X-Server-Powered-By"
          - "X-SourceFiles"
          - "X-SourceMap"
          - "X-Turbo-Charged-By"
          - "X-Varnish-Backend"
          - "X-Varnish-Server"
          - "X-Content-Security-Policy"
          - "X-WebKit-CSP"
          - "Content-Security-Policy-Report-Only"
          - "X-ChromeLogger-Data"
          - "X-ChromePhp-Data"
          - "X-Debug-Token"
          - "X-Debug-Token-Link"
strategy:
  run_once: /
