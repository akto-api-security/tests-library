# Remediation for INTEGER_MASS_ASSIGN_EXPLOIT

## Remediation Steps for Mass Assignment Vulnerability
Mass Assignment is a common security issue in web applications where an attacker can modify database records by manipulating HTTP responses. This vulnerability is mostly prevalent in applications which use dynamic binding to move user input into model instances.

Most modern web development languages and frameworks now include ways to protect against this. 
Hereâ€™s how to fix it for a few different languages:

### Python Flask
```Python
from flask import request
from sqlalchemy import update

@app.route('/user', methods=['POST'])
def update_user():
    user_id = request.form['id']
    name = request.form.get('name', '')
    email = request.form.get('email', '')
    # Make sure to only update fields that the user is allowed to change
    stmt = update(User).where(User.id == user_id).values(name=name, email=email)
    db.session.execute(stmt)
    db.session.commit()
    return 'User updated successfully'
```
### NodeJS and Express
```JavaScript
const express = require('express');
const router = express.Router();
const { check, validationResult } = require('express-validator');

router.put('/user',[ check('name').isLength({ min: 1 }), check('email').isEmail() ], async (req, res) => {
    let updates = {};
    ['name', 'email'].forEach(key => {
        if(req.body[key]) updates[key] = req.body[key];
    });
    try {
        const user = User.findByIdAndUpdate(req.body.id, updates, {new: true});
        res.status(200).send(user);
    } catch (err) {
        res.status(500).send(err);
    }
});
module.exports = router;
```
In these examples, we explicitly whitelist the user-editable fields using an array (`'name'`, `'email'`). This simple change will protect against mass assignment vulnerabilities by ensuring only specified fields are updated, regardless of what else an attacker includes in the request. 

Always remember to never trust user input and validate all fields before updating a database record.