---
id: REMOVE_CSRF_EVENUP
info:
  name: CSRF test by removing csrf token Custom 1753364254
  description: Assessing the system's vulnerability by removing the CSRF token to determine if unauthorized actions can be performed.
  details: |
    "Evaluating the effectiveness of the web application's CSRF protection mechanism by intentionally removing the CSRF token" "and assessing if unauthorized actions can be successfully executed, potentially exposing the system to security risks and breaches."
  impact: |
    "Successful execution of unauthorized actions due to the absence of CSRF token may result in severe consequences," "such as unauthorized data modification, account hijacking, or sensitive information disclosure," "highlighting critical vulnerabilities and emphasizing the need for robust CSRF protection measures."
  category:
    name: NO_AUTH
    shortName: Broken Authentication
    displayName: Broken User Authentication (BUA)
  subCategory: REMOVE_CSRF
  severity: HIGH
  tags:
  - Business logic
  - OWASP top 10
  - HackerOne top 10
  references:
  - https://portswigger.net/web-security/csrf
  - https://owasp.org/www-community/attacks/csrf
  - https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa2-broken-authentication.md
  cwe:
  - CWE-352
  cve:
  - CVE-2023-41942
  - CVE-2022-26180
attributes:
  nature: NON_INTRUSIVE
  plan: FREE
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
  and:
  - or:
    - request_headers:
        for_one:
          key:
            contains_either: csrf
          value:
            not_contains:
            - ':'
            - ;
execute:
  type: single
  requests:
  - req:
    - delete_header: "$magic remove csrf token header"
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    percentage_match:
      gt: 80
    length:
      gt: 0
    not_contains:
    - Error
    - Internal Server
    - Failed
    - Unauthorized
    - access denied
    - Forbidden
    - Method Not allowed
    - Gateway timeout
    - request timeout
    - server error
    - server busy
    - authentication error
    - authorization error
    - validation error
    - Permission Denied
    - invalid token
    - token expired
    - session expired
    - session timeout
    - unexpected error
    - unable to process request
    - bad request
    - service unavailable
    - account is locked
    - account is blocked
    - multiple failed attempts
