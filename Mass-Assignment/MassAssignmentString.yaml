id: STRING_MASS_ASSIGN_EXPLOIT
info:
  name: "Mass Assignment vulnerability test using String values"
  description: > 
    "Mass Assignment vulnerability test using String values involves examining whether 
    a web application's security is susceptible to unauthorized modification of sensitive 
    data through string parameters. This assessment typically involves manipulating string 
    inputs during form submissions to check if privileged fields can be altered. By 
    exploiting this vulnerability, attackers may gain unauthorized access or manipulate 
    data within the application."
  details: >
    "In this test, testers manipulate string parameters in form submissions to probe for 
    security weaknesses. By toggling string inputs, testers assess if privileged fields 
    can be modified without proper authorization. This assessment helps uncover potential 
    vulnerabilities where attackers could gain unauthorized access or tamper with sensitive 
    data within the application."
  impact: >
    "The impact of a Mass Assignment vulnerability, when exploited using string values, can 
    be severe. Attackers could gain unauthorized access to sensitive data or manipulate 
    system functionality. This can lead to breaches of confidentiality, integrity, and 
    availability, potentially causing financial loss, reputational damage, and regulatory 
    penalties for affected organizations. Additionally, it can undermine user trust and 
    compromise the overall security posture of the application."
  remediation: "To mitigate mass assignment vulnerabilities using string values, implement strict input validation and parameterization in your application. Ensure that string values are properly sanitized and validated against a whitelist of allowed values to prevent injection attacks. Limit mass assignment to specific attributes and enforce strong access controls to prevent unauthorized modifications. Regularly review and update your codebase to address any potential vulnerabilities, and conduct thorough security testing using various string values to identify and remediate any mass assignment issues. Additionally, consider implementing automated security testing tools to proactively detect and prevent such vulnerabilities."
  category:
    name: MA
    shortName: Mass Assignment
    displayName: Mass Assignment (MA)
  subCategory: STRING_MASS_ASSIGN_EXPLOIT
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa3-broken-object-property-level-authorization.md"
  cwe:
    - CWE-915
  cve:
    - CVE-2023-32079
    - CVE-2023-42768
wordLists:
  stringvalues:
    - admin
    - superuser
    - customer
    - moderator

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
    extract: resp_code
  method:
    neq: GET
  request_payload:
    for_one:
      key:
        regex: .*
        extractMultiple: payloadKeys
  response_payload:
    for_one:
      key:
        not_contains: "${payloadKeys}"
        extractMultiple: extraKeys
      value:
        datatype: string
execute:
  type: single
  requests:
  - req:
    - add_body_param:
        ${extraKeys}: "${stringvalues}"
validate:
  response_code:
    eq: ${resp_code}
  response_payload:
    for_one:
      key:
        contains_either: ${extraKeys}
      value:
        contains_either: ${stringvalues}