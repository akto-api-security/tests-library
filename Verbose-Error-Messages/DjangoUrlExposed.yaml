id: DJANGO_URL_EXPOSED
info:
  name: Django url exposed due to debug mode enable
  description: "The error response contains information related to urls which may help in more sophisticated attacks"
  details: >
    "The endpoint appears to be give out information related to endpoints existing in the application, on trying an invalid request, possibly due to DJANGO DEBUG mode being enabled. The original request
    was replayed by modifying the url with an invalid value.
    "<b>Background:</b> Inconsistencies in error messages can reveal important clues on how a site works,  and what information is present under the covers.
  impact: "This information can be used to facilitate more sophisticated attacks on your application"
  category:
    name: VEM
    shortName: Verbose Error Messages
    displayName: Verbose Error Messages (VEM)
  subCategory: DJANGO_URL_EXPOSED
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/www-community/Improper_Error_Handling"
    - "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_For_Improper_Error_Handling"
    - "https://hackerone.com/reports/1033423"
  cwe:
    - CWE-215
    - CWE-489
  cve:
    - CVE-2017-12794

attributes:
  nature: NON-INTRUSIVE
  plan: STANDARD
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
  HIPAA:
    - 45 CFR ยง 164.312(c)(1)
    - 45 CFR ยง 164.308(a)(1)(ii)(A)
  SOC 2:
    - System and Communication Security
    - Vulnerability and Configuration Management
  PCI DSS:
    - Requirement 6.5.1
    - Requirement 6.5.10
  ISO 27001:
    - A.12.4.1
    - A.12.6.1
  NIST 800-53:
    - SI-11
    - SI-10
  CSA CCM:
    - APP-02
    - TVM-03
  CIS Controls:
    - IG1 Safeguard 4.7
    - IG1 Safeguard 16.3
  FedRAMP:
    - SI-11
    - SI-10
  NIST 800-171:
    - 3.14.1
    - 3.14.3
  FISMA:
    - SI-11
    - SI-10
  Cybersecurity Maturity Model Certification (CMMC):
    - SI.2.216
    - CM.2.068
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar
  response_payload:
    length:
      gt: 0
    not_contains:
      - "Django tried these url patterns"
      - "Django version"
      - "Exception Type"
      - "Template rendering"
      - "Request Method"
      - "Request URL"
      - "Django Settings"
      - "Python Executable"
      - "Python Path"
      - "Server time"

execute:
  type: single
  requests:
    - req:
        - modify_url: ${urlVar}testInvalidUrl

validate:
  response_payload:
    length:
      gt: 0
    contains_all:
      - "debug=true"
      - "false"
      - django
      - error
      - settings
      - standard
