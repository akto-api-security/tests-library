id: EXCESSIVE_ERROR_MESSAGE_GRAPHQL
info:
  name: Descriptive Error Message Using fuzzing payloads in graphQL
  description: "GraphQL has a nice and expressive way of returning errors. However, error messages can be too informative."
  details: >
          "GraphQL has a nice and expressive way of returning errors. However, error messages can be too informative.
          Try to cause errors, for instance by fuzzing parameters, error messages can reveal details about the error, actual paths on the system, chunks of code or queries, etc."
  impact: "Error messages can reveal details about the error, actual paths on the system, chunks of code or queries, etc. This information can be used to facilitate more sophisticated attacks on your application"
  category:
    name: VEM
    shortName: VEM
    displayName: Verbose Error Messages (VEM)
  subCategory: EXCESSIVE_ERROR_MESSAGE_GRAPHQL
  severity: LOW
  tags: 
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://0xn3va.gitbook.io/cheat-sheets/web-application/graphql-vulnerabilities#excessive-errors"
    - "https://owasp.org/www-community/Improper_Error_Handling"
  cwe:
    - CWE-209

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    contains_either: graphql
  request_payload:
    for_one:
      key:
        regex: "[a-zA-Z0-9]{4,}"
        extract: key_var
      value:
        extract: value_var

execute:
  type: single
  requests:
    - req:
      - delete_body_param: ${key_var}
      - add_body_param:
          key_var: ${value_var}
          
validate:
  response_payload:
    - contains_either:
      - "did you mean"
