---
id: AUTHENTICATION_WITH_WRONG_AUTH_SCHEME_MCP
info:
  name: Authentication with Wrong Authorization Scheme (MCP)
  description: |
    This test checks whether the MCP server strictly enforces the use of the expected authorization scheme.
  details: |
    The request modifies the Authorization header to use the "Basic" scheme instead of the expected "Bearer" scheme. If the server accepts this modification, it indicates weak authentication enforcement.
  impact: |
    Accepting requests with the wrong authorization scheme may allow bypassing intended authentication mechanisms or introduce unexpected behavior.
  category:
    name: MCP_AUTH
    shortName: MCP_AUTH
    displayName: Model Context Protocol (MCP) Security - Broken Authentication
  subCategory: AUTHENTICATION_WITH_WRONG_AUTH_SCHEME_MCP
  severity: HIGH
  tags:
  - Authentication
  - OWASP top 10
  - Business logic
  references:
  - https://portswigger.net/web-security/authentication
  - https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
  cwe:
  - CWE-287
  cve:
  - CVE-2023-27997
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
  request_headers:
    for_one:
      key:
        regex: .*
        extract: authHeaderKey
      value:
        regex: ^Bearer.*
        extract: authHeaderVal
execute:
  type: single
  requests:
  - req:
    - modify_header:
        authHeaderKey: "Basic ${authHeaderVal}"
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    contains_either: "$magic check if the response is invalid and failed due to authentication or authorization error. If yes then return not_found. Else return list of words from the successful response."