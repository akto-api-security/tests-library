---
id: AUTHENTICATION_WITH_WRONG_AUTH_SCHEME_MCP
info:
  name: Authentication with Wrong Authorization Scheme (MCP)
  description: |
    This test checks whether the MCP server strictly enforces the use of the expected authorization scheme.
  details: |
    The request modifies the Authorization header to use the "Basic" scheme instead of the expected "Bearer" scheme. If the server accepts this modification, it indicates weak authentication enforcement.
  impact: |
    Accepting requests with the wrong authorization scheme may allow bypassing intended authentication mechanisms or introduce unexpected behavior.
  category:
    name: MCP_AUTH
    shortName: MCP_AUTH
    displayName: Model Context Protocol (MCP) Security - Broken Authentication
  subCategory: AUTHENTICATION_WITH_WRONG_AUTH_SCHEME_MCP
  severity: HIGH
  tags:
  - Authentication
  - OWASP top 10
  - Business logic
  references:
  - https://portswigger.net/web-security/authentication
  - https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
  cwe:
  - CWE-287
  cve:
  - CVE-2023-27997
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
  request_headers:
    for_one:
      key:
        regex: .*
        extract: authHeaderKey
      value:
        regex: ^Bearer.*
        extract: authHeaderVal
execute:
  type: single
  requests:
  - req:
    - modify_header:
        authHeaderKey: "Basic ${authHeaderVal}"
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    contains_either: "$magic Check whether the response contains any kind of error response (error status, error fields, error messages, error flags or any json key related to error) related to authentication failure. If there is any error then return nothing just empty braces []. Else return a list of words from the response only in case of successful response."
