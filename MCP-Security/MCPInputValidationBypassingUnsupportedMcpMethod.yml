---
id: INPUT_VALIDATION_BY_PASSING_UNSUPPORTED_MCP_METHOD
info:
  name: Input Validation by passing unsupport mcp method
  description: |
    This test checks whether the MCP server properly validates unsupported or unexpected values in the method field of an MCP request.
  details: |
    The test modifies the method value in the JSON-RPC request (e.g., to tools/attack) to an invalid or undefined value. This helps assess if the server appropriately validates method names and rejects calls to unauthorized or undefined methods.
  impact: |
    If unsupported method names are accepted or executed, it may indicate weak validation, misconfigured routing, or potential backdoor exposure. This can lead to misuse of internal functionality or unauthorized access.
  category:
    name: MCP_INPUT_VALIDATION
    shortName: MCP_INPUT_VALIDATION
    displayName: Model Context Protocol (MCP) Security - Input Validation
  subCategory: INPUT_VALIDATION_BY_PASSING_UNSUPPORTED_MCP_METHOD
  severity: LOW
  tags:
  - Business logic
  - OWASP top 10
  - HackerOne top 10
  references:
  - https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/
  - https://www.jsonrpc.org/specification
  cwe:
  - CWE-20
  cve:
  - CVE-2018-20487
  - CVE-2024-20381
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
    for_one:
      key:
        regex: method
        extract: mcpMethodKey
execute:
  type: single
  requests:
  - req:
    - modify_body_param:
        mcpMethodKey: tools/attack
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
    contains_either: "$magic Check whether the response is a valid successful response or not. If it contains errors then return contains_either: []. Else return contains_either: [<word1>, <word2>,....]"