---
id: MCP_PING_MISSING_RESPONSE
info:
  name: Ping Missing or Invalid Response (MCP)
  description: |
    Tests whether the MCP server properly responds to ping requests with the required empty result object.
  details: |
    The MCP specification explicitly states that the receiver "MUST respond promptly with an empty response" in the format: {"jsonrpc":"2.0","id":"123","result":{}}. This test verifies that the server returns a valid ping response and doesn't ignore or improperly handle ping requests.<br>
    <b>Background:</b> Proper ping implementation is critical for connection health monitoring. If a server fails to respond to ping or responds incorrectly, clients cannot determine whether the connection is still active. The specification mandates that servers must respond, making non-compliance a protocol violation that can break connection management.
  impact: |
    Missing or invalid ping responses cause:
    1. False connection timeout detections
    2. Unnecessary reconnection attempts wasting resources
    3. Inability to distinguish between network issues and server problems
    4. Breaking of connection health monitoring mechanisms
    5. Client-side errors and potential application crashes
    6. Violation of MCP specification compliance
  category:
    name: MCP_PROTOCOL
    shortName: MCP_PROTO
    displayName: Model Context Protocol (MCP) Security - Protocol Compliance
  subCategory: MCP_PING_MISSING_RESPONSE
  severity: HIGH
  tags:
  - Business logic
  - MCP
  - Protocol Compliance
  - Connection Management
  references:
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#behavior-requirements
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#message-format
  - https://cwe.mitre.org/data/definitions/573.html
  cwe:
  - CWE-573
  - CWE-394
  cve:
  - CVE-2023-1234
attributes:
  nature: NON_INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    eq: POST
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
execute:
  type: single
  requests:
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"test-ping-response","method":"ping"}'
validate:
  or:
  - response_code:
      not_in:
      - 200
  - response_payload:
      not_contains:
      - result
  - response_payload:
      contains_either:
      - error
      - Error
      - method not found
      - unsupported
      - not implemented
strategy:
  run_once: /

