---
id: MCP_METHOD_NOT_FOUND
info:
  name: Method Not Found (MCP)
  description: >
    This test checks whether the MCP server correctly handles calls to unknown or non-existent methods.
    It verifies that a well-formed JSON-RPC error is returned with the appropriate MCP error code (-32601).
  details: >
    The test modifies the `method` field of a valid MCP request to use an invalid, authentic-looking method name.
    A compliant server must return error code -32601 without leaking internal tracebacks or debugging details.
  impact: >
    Improper handling of unknown method calls may lead to broken clients or information exposure.
  category:
    name: MCP
    shortName: MCP
    displayName: Model Context Protocol (MCP) Security
  subCategory: MCP_METHOD_NOT_FOUND
  severity: MEDIUM
  tags:
    - Error handling
    - MCP compliance
    - jsonrpc
  references:
    - https://www.jsonrpc.org/specification#error_object
  cwe:
    - CWE-209
  cve: []
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  and:
    - request_payload:
      - contains_all:
        - jsonrpc
        - method
        - params
      - for_one:
          key:
            eq: method
            extract: changed_method
          value:
            regex: ^(?!(tools/list|resources/list|prompts/list)$).*

wordLists:
  invalidMethodNames:
    - "tools/invalidSecurePrompt"
    - "resources/fakeResourceSync"
    - "prompts/nonExistentFlow"
    - "tools/invokeImaginary"
    - "resources/missingCall"
  methodNotFoundCode:
    - '-32601'
  errorIndicators:
    - "Traceback"
    - "Exception"
    - "RuntimeError"
    - "StackTrace"
execute:
  type: single
  requests:
    - req:
        - add_header:
            x-akto-ignore: 123
        - modify_body_param:
            changed_method: ${invalidMethodNames}
validate:
  response_payload:
    magic_validate: |
        VULNERABLE = TRUE only when:
        - the response succeeded without any error traces related to invalid request or invalid parameters or invalid method or method not found

        VULNERABLE = FALSE if ANY of the following are true:
        - The response clearly says invalid request, invalid parameters, invalid method, method not found, etc.
