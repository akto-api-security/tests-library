---
id: MCP_METHOD_NOT_FOUND
info:
  name: Method Not Found (MCP)
  description: >
    This test checks whether the MCP server correctly handles calls to unknown or non-existent methods.
    It verifies that a well-formed JSON-RPC error is returned with the appropriate MCP error code (-32601).
  details: >
    The test modifies the `method` field of a valid MCP request to use an invalid, authentic-looking method name.
    A compliant server must return error code -32601 without leaking internal tracebacks or debugging details.
  impact: >
    Improper handling of unknown method calls may lead to broken clients or information exposure.
  category:
    name: MCP
    shortName: MCP
    displayName: Model Context Protocol (MCP) Security
  subCategory: MCP_METHOD_NOT_FOUND
  severity: MEDIUM
  tags:
    - Error handling
    - MCP compliance
    - jsonrpc
  references:
    - https://www.jsonrpc.org/specification#error_object
  cwe:
    - CWE-209
  cve: []
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  and:
    - request_payload:
        for_one:
          key:
            eq: method
            extract: changed_method
    - request_payload:
        contains_all:
          - jsonrpc
          - method
          - params
wordLists:
  invalidMethodNames:
    - "tools/invalidSecurePrompt"
    - "resources/fakeResourceSync"
    - "prompts/nonExistentFlow"
    - "tools/invokeImaginary"
    - "resources/missingCall"
  methodNotFoundCode:
    - '-32601'
  errorIndicators:
    - "Traceback"
    - "Exception"
    - "RuntimeError"
    - "StackTrace"
execute:
  type: single
  requests:
    - req:
        - add_header:
            x-akto-ignore: 123
        - modify_body_param:
            changed_method: ${invalidMethodNames}
validate:
  response_payload:
    magic_validate: |
        Mark the response as VULNERABLE only if the server fails to handle
        an unknown or non-existent MCP method correctly.

        VULNERABLE = TRUE only when:
        - The response does NOT include a valid JSON-RPC / MCP "method not found" indication
        - Error code -32601 (or an equivalent explicit “method not found” signal) is missing
        - The response leaks internal implementation details, such as:
        - Stack traces
        - Tracebacks
        - Exception names
        - Runtime or debugging information
        - The response exposes internal method resolution logic or server internals

        VULNERABLE = FALSE if ANY of the following are true:
        - The response correctly indicates that the method was not found
        (e.g., error code -32601 or a clear equivalent message)
        - The response is a clean, well-formed JSON-RPC error without internal details
        - No stack traces, debug output, or internal exceptions are present
        - The server safely rejects the invalid method without leaking information

        Only improper handling of unknown methods or information disclosure
        qualifies as a vulnerability.
