---
id: MCP_PING_NO_RATE_LIMITING
info:
  name: Missing Rate Limiting on Ping Requests (MCP)
  description: |
    Tests whether the MCP server implements rate limiting on ping requests to prevent abuse.
  details: |
    The MCP specification states that "The frequency of pings SHOULD be configurable" and "Excessive pinging SHOULD be avoided to reduce network overhead." This test verifies whether the server enforces rate limiting on ping requests by sending multiple rapid pings and checking if the server accepts all of them without throttling.<br>
    <b>Background:</b> Rate limiting is a crucial security control for preventing resource exhaustion attacks. While the MCP specification recommends avoiding excessive pinging, it doesn't mandate specific rate limits. Servers without rate limiting are vulnerable to abuse where attackers can consume server resources through legitimate-looking ping requests.
  impact: |
    Lack of rate limiting on ping requests enables:
    1. Resource exhaustion through legitimate API calls
    2. Amplification attacks using ping as a vector
    3. Network congestion and bandwidth consumption
    4. Degraded performance for legitimate users
    5. Potential server crashes under sustained load
    6. Inability to distinguish between legitimate health checks and attacks
  category:
    name: MCP_DOS
    shortName: MCP_DOS
    displayName: Model Context Protocol (MCP) Security - Denial of Service
  subCategory: MCP_PING_NO_RATE_LIMITING
  severity: MEDIUM
  tags:
  - Business logic
  - OWASP top 10
  - MCP
  - Rate Limiting
  - Resource Management
  references:
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#implementation-considerations
  - https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa4-unrestricted-resource-consumption.md
  - https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html
  cwe:
  - CWE-770
  - CWE-400
  - CWE-799
  cve:
  - CVE-2023-38254
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    eq: POST
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
execute:
  type: multiple
  requests:
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-1","method":"ping"}'
    - validate:
        response_code:
          gte: 200
          lt: 300
    - success: x1
    - failure: exit
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-2","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-3","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-4","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-5","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-6","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-7","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-8","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-9","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-10","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-11","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-12","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-13","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-14","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-15","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-16","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-17","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-18","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-19","method":"ping"}'
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-20","method":"ping"}'
validate:
  and:
  - response_code:
      gte: 200
      lt: 300
  - response_payload:
      not_contains:
      - rate limit exceeded
      - too many requests
      - rate_limit
      - throttled
      - slow down
      - quota exceeded
      - limit reached
      - retry after
      - requests per
      - Error
      - error
strategy:
  run_once: /

