---
id: MCP_PING_INVALID_JSONRPC
info:
  name: Ping with Invalid JSON-RPC Version (MCP)
  description: |
    Tests whether the MCP server properly validates the JSON-RPC version field in ping requests and rejects invalid versions.
  details: |
    The MCP specification requires all requests to use JSON-RPC 2.0 format with "jsonrpc":"2.0". This test sends ping requests with invalid or missing JSON-RPC version fields to verify proper protocol validation. Accepting invalid JSON-RPC versions indicates weak input validation.<br>
    <b>Background:</b> JSON-RPC 2.0 is a strict protocol specification. Servers should validate the version field and reject requests that don't comply with the specification. Accepting invalid versions can indicate broader input validation weaknesses and protocol non-compliance that may be exploitable.
  impact: |
    Accepting invalid JSON-RPC versions can result in:
    1. Protocol confusion attacks
    2. Broader input validation bypass opportunities
    3. Unexpected server behavior with malformed requests
    4. Compatibility issues with spec-compliant clients
    5. Potential for exploitation through version-specific vulnerabilities
    6. Inability to maintain protocol versioning integrity
  category:
    name: MCP_INPUT_VALIDATION
    shortName: MCP_INPUT
    displayName: Model Context Protocol (MCP) Security - Input Validation
  subCategory: MCP_PING_INVALID_JSONRPC
  severity: LOW
  tags:
  - Business logic
  - MCP
  - Input Validation
  - Protocol Compliance
  references:
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#message-format
  - https://www.jsonrpc.org/specification
  - https://cwe.mitre.org/data/definitions/20.html
  cwe:
  - CWE-20
  - CWE-573
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    eq: POST
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
execute:
  type: multiple
  requests:
  # Missing jsonrpc field
  - req:
    - replace_body: '{"id":"ping-no-version","method":"ping"}'
  # Wrong version
  - req:
    - replace_body: '{"jsonrpc":"1.0","id":"ping-wrong-version","method":"ping"}'
  # Invalid version
  - req:
    - replace_body: '{"jsonrpc":"3.0","id":"ping-future-version","method":"ping"}'
  # Empty version
  - req:
    - replace_body: '{"jsonrpc":"","id":"ping-empty-version","method":"ping"}'
  # Malformed version
  - req:
    - replace_body: '{"jsonrpc":null,"id":"ping-null-version","method":"ping"}'
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    not_contains:
    - invalid request
    - invalid jsonrpc
    - version required
    - unsupported version
    - Error
    - error
strategy:
  run_once: /

