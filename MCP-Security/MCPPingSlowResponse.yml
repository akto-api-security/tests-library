---
id: MCP_PING_SLOW_RESPONSE
info:
  name: Ping Slow Response Time Detection (MCP)
  description: |
    Tests whether the MCP server responds to ping requests promptly as required by the specification.
  details: |
    According to the MCP Ping specification, "The receiver MUST respond promptly with an empty response." This test measures the response time of ping requests to ensure the server is responding in a timely manner. Slow responses indicate potential performance issues, resource constraints, or attacks in progress.<br>
    <b>Background:</b> The purpose of ping is to verify connection health and responsiveness. If ping responses are slow, the mechanism cannot effectively serve its purpose. The specification states that "Timeouts SHOULD be appropriate for the network environment" and recommends that implementations should respond promptly. Slow ping responses can indicate server overload, inefficient implementation, or active attacks.
  impact: |
    Slow ping responses result in:
    1. Inability to accurately detect connection health
    2. False positives in timeout detection leading to unnecessary reconnections
    3. Resource waste as clients wait for responses
    4. Degraded user experience in applications relying on health checks
    5. Potential cascade failures as dependent systems incorrectly assume connection loss
    6. Difficulty in distinguishing between network latency and server problems
  category:
    name: MCP_PERFORMANCE
    shortName: MCP_PERF
    displayName: Model Context Protocol (MCP) Security - Performance
  subCategory: MCP_PING_SLOW_RESPONSE
  severity: MEDIUM
  tags:
  - Business logic
  - MCP
  - Performance
  - Availability
  references:
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#behavior-requirements
  - https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping#implementation-considerations
  - https://cwe.mitre.org/data/definitions/405.html
  cwe:
  - CWE-405
  - CWE-400
attributes:
  nature: NON_INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    eq: POST
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
execute:
  type: multiple
  requests:
  # Baseline normal request
  - req:
    - add_header:
        X-Test-Baseline: "true"
    - validate:
        response_code:
          gte: 200
          lt: 300
    - success: x1
    - failure: exit
  # Ping request
  - req:
    - replace_body: '{"jsonrpc":"2.0","id":"ping-timing-test","method":"ping"}'
    - validate:
        response_code:
          gte: 200
          lt: 300
        response_payload:
          contains_either:
          - result
    - success: x2
validate:
  and:
  - response_code:
      gte: 200
      lt: 300
  - compare_greater:
      - ${x2.response.stats.median_response_time}
      - 3000
  - response_payload:
      not_contains:
      - Error
      - error
      - timeout
      - slow
strategy:
  run_once: /

