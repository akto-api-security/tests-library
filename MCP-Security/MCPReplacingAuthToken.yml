---
id: REPLACE_AUTH_TOKEN_MCP
info:
  name: BOLA by changing auth token (MCP)
  description: Attacker can access resources of any user by changing the auth token in request.
  details: |
    "The endpoint appears to be vulnerable to broken object level authorization attack. The original request was replayed with attacker's auth token. The server responded with 2XX success codes and greater than <b>{{percentageMatch}}%</b> of the response body matched with original response body. Also, the endpoint had atleast one private resources in request payload.<br>" "<b>Background:</b> Object level authorization is an access control mechanism that is usually implemented at the code level to
    validate that one user can only access objects that they should have access to.
    Unauthorized access can result in data disclosure to unauthorized parties, data loss, or data manipulation. Unauthorized access to objects can also lead to full account takeover."
  impact: "Unauthorized access can result in data disclosure to unauthorized parties, data loss, or data manipulation. Unauthorized access to objects can also lead to full account takeover."
  category:
    name: MCP
    shortName: MCP
    displayName: Model Context Protocol (MCP) Security
  subCategory: REPLACE_AUTH_TOKEN_MCP
  severity: CRITICAL
  tags:
  - Business logic
  - OWASP top 10
  - HackerOne top 10
  references:
  - https://www.akto.io/blog/bola-exploitation-using-unauthorized-uuid-on-api-endpoint
  - https://www.akto.io/blog/what-is-broken-object-level-authorization-bola
  - https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa1-broken-object-level-authorization.md
  - https://cwe.mitre.org/data/definitions/284.html
  - https://cwe.mitre.org/data/definitions/285.html
  - https://cwe.mitre.org/data/definitions/639.html
  cwe:
  - CWE-284
  - CWE-285
  - CWE-639
  cve:
  - CVE-2023-39349
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
auth:
  authenticated: true
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
  method:
    eq: POST
execute:
  type: single
  requests:
  - req:
    - replace_auth_header: true
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    not_contains:
    - Error
    - Internal Server
    - Failed
    - Unauthorized
    - access denied
    - Forbidden
    - Method Not allowed
    - Gateway timeout
    - request timeout
    - server error
    - server busy
    - authentication error
    - authorization error
    - validation error
    - Permission Denied
    - invalid
    - token expired
    - session expired
    - session timeout
    - unexpected error
    - unable to process request
    - bad request
    - service unavailable
    - account is locked
    - account is blocked
    - multiple failed attempts
