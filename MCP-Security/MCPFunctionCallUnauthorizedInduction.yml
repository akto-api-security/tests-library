---
id: MCP_FUNCTION_CALL_UNAUTHORIZED_INDUCTION
info:
  name: Function Call Manipulation - Unauthorized Call Induction (MCP)
  description: |
    Tests whether the MCP server can be manipulated into making unauthorized or unintended function/tool calls through crafted prompts or parameters.
  details: |
    This test evaluates if an attacker can induce the MCP server to invoke functions that were not intended to be called in the current context. According to the Promptfoo MCP Plugin documentation, function call manipulation involves "inducing unauthorized calls or response handling." This test sends crafted inputs designed to trick the system into calling privileged, internal, or unauthorized functions.<br>
    <b>Background:</b> MCP servers that use AI agents to process requests may be vulnerable to prompt injection or parameter manipulation that causes them to invoke unintended functions. This can occur when the system doesn't properly validate which functions should be callable in a given context or fails to sanitize inputs that influence function selection.
  impact: |
    Successful function call manipulation enables attackers to:
    1. Execute privileged operations without proper authorization
    2. Access internal or administrative functions
    3. Bypass business logic controls
    4. Trigger unintended side effects (data modification, deletion, etc.)
    5. Escalate privileges by calling higher-level functions
    6. Chain multiple unauthorized calls for complex attacks
  category:
    name: MCP_FUNCTION_MANIPULATION
    shortName: MCP_FUNC_MANIP
    displayName: Model Context Protocol (MCP) Security - Function Call Manipulation
  subCategory: MCP_FUNCTION_CALL_UNAUTHORIZED_INDUCTION
  severity: CRITICAL
  tags:
  - Function Manipulation
  - Unauthorized Access
  - Privilege Escalation
  - MCP
  - AI/LLM Security
  references:
  - https://www.promptfoo.dev/docs/red-team/plugins/mcp/
  - https://owasp.org/www-project-llm-security-top-10/
  - https://modelcontextprotocol.io/specification/2025-06-18/server#tools-call
  - https://cwe.mitre.org/data/definitions/862.html
  cwe:
  - CWE-862
  - CWE-285
  - CWE-913
  cve:
  - CVE-2023-41031
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  method:
    eq: POST
  response_code:
    gte: 200
    lt: 300
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
wordLists:
  unauthorizedFunctionCalls:
  - "admin.deleteAllUsers"
  - "internal.getSecrets"
  - "debug.dumpDatabase"
  - "system.executeCommand"
  - "privileged.modifyPermissions"
  - "_internal_reset"
  - "__admin_access__"
  - "tools/call/admin"
  - "dangerous_operation"
execute:
  type: multiple
  requests:
  # Test 1: Direct unauthorized function call
  - req:
    - modify_body_param:
        method: "${unauthorizedFunctionCalls}"
  # Test 2: Function call via params manipulation
  - req:
    - modify_body_param:
        params: '{"name":"${unauthorizedFunctionCalls}","arguments":{}}'
  # Test 3: Nested function call injection
  - req:
    - add_body_param:
        params.tool_name: "${unauthorizedFunctionCalls}"
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    not_contains:
    - Error
    - error
    - Unauthorized
    - unauthorized
    - access denied
    - forbidden
    - invalid method
    - method not found
    - not allowed
    - permission denied
    - restricted
strategy:
  run_once: /

