---
id: MCP_INVALID_REQUEST_REMOVED_PARAM
info:
  name: Invalid Request via Malformed Params (MCP)
  description: |
    This test checks how the MCP server handles structurally invalid JSON-RPC requests by modifying required fields in the `params` object (e.g., removing or corrupting mandatory subfields), triggering an `-32600` Invalid Request error.
  details: |
    The JSON-RPC specification defines an "Invalid Request" error (`-32600`) for cases where the entire request object is not a valid JSON-RPC structure. In this test, we deliberately damage the structure inside `params` while maintaining the rest of the envelope (method, jsonrpc, id) as valid to trigger this error.
  impact: |
    Improper error handling may leak internal stack traces, logs, or service behavior.
  category:
    name: MCP
    shortName: MCP
    displayName: Model Context Protocol (MCP) Security
  subCategory: MCP_INVALID_REQUEST_REMOVED_PARAM
  severity: MEDIUM
  tags:
  - jsonrpc
  - malformed params
  - invalid structure
  references:
  - https://www.jsonrpc.org/specification#error_object
  cwe:
  - CWE-707
attributes:
  nature: INTRUSIVE
  plan: PRO
  duration: FAST
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  method:
    eq: POST
  request_payload:
    contains_all:
    - jsonrpc
    - method
    - params
    for_one:
      key:
        regex: params
        extract: paramsKey
wordLists:
  invalidRequestCode:
  - "-32600"
  errorIndicators:
  - Traceback
  - StackTrace
  - Exception
  - RuntimeError
execute:
  type: single
  requests:
  - req:
    - delete_body_param: paramsKey
validate:
  response_payload:
    or:
    - contains_either: "${invalidRequestCode}"
    - contains_either: |
        $magic Analyze the full request and response to determine if the model rejected the JSON-RPC request as structurally invalid. A proper response should include error code -32600 and must not leak debugging or internal information.
