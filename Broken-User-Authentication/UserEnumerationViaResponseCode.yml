id: USER_ENUM_HTTP_CODES
info:
  name: "Broken Authentication Test - Username Enumeration via Different HTTP response codes"
  description: > 
    "In this test, testers assess a system's security by analyzing how it responds to authentication 
    requests with valid and invalid usernames. The focus is on variations in HTTP response codes, 
    revealing potential vulnerabilities in the username enumeration process. Identifying 
    and addressing these issues is crucial for bolstering authentication security and 
    preventing the unintentional exposure of valid username information."
  details: >
    "This test assesses a system's security by analyzing responses to authentication requests 
    with various usernames. Testers focus on distinct HTTP response codes for valid and invalid 
    attempts, revealing potential vulnerabilities. Identifying and addressing these issues is 
    vital for strengthening authentication security and preventing inadvertent disclosure of 
    valid username information."
  impact: >
    "A successful Broken Authentication Test - Username Enumeration via Different HTTP Response Codes 
    could have significant consequences. Exploiting variations in response codes may expose valid 
    usernames, aiding attackers in targeted unauthorized access. This vulnerability could lead 
    to compromised user accounts, potential data breaches, and an increased risk of unauthorized 
    system entry. Addressing these issues promptly is crucial to maintaining robust authentication 
    security and preventing the inadvertent exposure of sensitive user information."

  category:
    name: NO_AUTH
    shortName: Broken Authentication
    displayName: Broken User Authentication (BUA)
  subCategory: USER_ENUM_HTTP_CODES
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/"
    - "https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa2-broken-user-authentication.md"
    - "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
  cwe:
    - CWE-287
  cve:
    - CVE-2020-24008
    - CVE-2021-45901

api_selection_filters:
  response_code:
    gte: 200
execute:
  type: multiple
  requests:
  - req:
    - modify_body_param:
        password: xyz
    - validate:
        response_code:
          gte: 400
  - req:
    - modify_body_param:
        email: xyz@abc.com
        password: dfk
    - validate:
        response_code:
          neq: "${x1.response_code}"
validate:
  response_code:
    gte: 400