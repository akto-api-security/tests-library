id: USER_ENUM_RESPONSE_CONTENT
info:
  name: "Broken Authentication Test - Username Enumeration via Different response content"
  description: > 
    "Username Enumeration via Different Response Content involves scrutinizing authentication 
    responses for variations in content when submitting requests with valid and invalid usernames. 
    Testers analyze response discrepancies, such as distinct error messages or timing variations, 
    to identify potential vulnerabilities. This method aims to pinpoint weaknesses in the 
    authentication process that could inadvertently reveal information about valid user accounts, 
    enhancing overall security measures against unauthorized access."
  details: >
    "This test involves analyzing system responses to authentication requests with 
    valid and invalid usernames. Testers focus on variations in response content, such 
    as error messages or timing, to uncover potential vulnerabilities. This testing 
    method aims to enhance security by identifying and mitigating risks associated 
    with unintentional disclosure of valid username information during the authentication process."
  impact: >
    "The impact of a successful Broken Authentication Test - Username Enumeration via Different 
    Response Content can be significant. Exploiting response variations may disclose valid usernames, 
    aiding attackers in targeted unauthorized access attempts. This vulnerability could lead to 
    compromised user accounts, potential data breaches, and a heightened risk of unauthorized 
    system entry. Addressing these issues is crucial for maintaining robust authentication security 
    and safeguarding against the inadvertent exposure of sensitive user information."

  category:
    name: NO_AUTH
    shortName: Broken Authentication
    displayName: Broken User Authentication (BUA)
  subCategory: USER_ENUM_RESPONSE_CONTENT
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/"
    - "https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa2-broken-user-authentication.md"
    - "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
  cwe:
    - CWE-287
  cve:
    - CVE-2023-3897
    - CVE-2023-40758

api_selection_filters:
  response_code:
    gte: 200
execute:
  type: multiple
  requests:
  - req:
    - modify_body_param:
        password: xyz
    - validate:
        response_code:
          gte: 400
  - req:
    - modify_body_param:
        email: xyz@abc.com
        password: dfk
    - validate:
        response_payload:
          neq: "${x1.response}" # content matching
        response_code:
          eq: "${x1.response_code}"
validate:
  response_code:
    gte: 400