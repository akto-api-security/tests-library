#Broken brute-force protection, multiple credentials per request

api_selection_filters:
  response_code:
    gte: 200
    lte: 300
  url:
    contains_either:
    - login
    ... arjun to add wordlist for identifying login endpoints
  request_payload:
    for_one:
      key:
        regex: ... arjun to add password key regex
        extract: passwordkey
    extract: respbody
execute:
  type: single
  requests:
  - req:
    - modify_body_param:
        passwordkey:
        - "${respbody}"
validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    percentage_match_schema:
      gt: 90