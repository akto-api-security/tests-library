id: DOS_ATTACH_FILE_IN_BODY
info:
  name: "Denial of Service test by providing a large file in Request Body"
  description: "In this Denial of Service (DoS) test, a large file is included in the request 
  body to overwhelm the targeted system's processing capabilities. By inundating the 
  system with excessive data in the request payload, this test aims to evaluate its 
  resilience against resource exhaustion attacks. It assesses the system's ability to 
  handle and process large volumes of data efficiently, identifying potential vulnerabilities 
  in its defense mechanisms against DoS incidents."
  details: "In this test, a large file is sent within the request body to exhaust the 
  system's processing resources, potentially causing it to become unresponsive. By 
  inundating the system with excessive data, it evaluates its ability to handle 
  and process incoming requests efficiently. This test helps uncover vulnerabilities 
  in the system's defenses against Denial of Service (DoS) attacks, highlighting areas 
  for improvement in its resilience and response mechanisms."
  impact: "The impact of this test can disrupt essential services, leading to system 
  downtime and hindering user access. By overwhelming processing resources, legitimate 
  requests may be delayed or denied, resulting in degraded performance and user 
  frustration. Moreover, if not adequately mitigated, such vulnerabilities could 
  be exploited by attackers to execute more severe attacks, potentially compromising 
  system integrity and exposing sensitive data."
  remediation: "To prevent Denial of Service (DoS) attacks from large file uploads, implement file size limits for request bodies. You can configure server-side validation to reject requests with excessively large files, ensuring that the server resources are not overwhelmed. Additionally, consider implementing rate limiting or request throttling to prevent multiple large requests from consuming all available server resources simultaneously. Regularly monitor server performance and adjust limits as needed to maintain optimal service availability and performance."
  category:
    name: RL
    shortName: Lack of Resources & Rate Limiting
    displayName: Lack of Resources & Rate Limiting (RL)
  subCategory: DOS_ATTACH_FILE_IN_BODY
  severity: HIGH
  tags:
  - Business logic
  - OWASP top 10
  - HackerOne top 10
  references:
  - "https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa4-unrestricted-resource-consumption.md"
  cwe:
  - CWE-400
  cve:
  - CVE-2023-4647
  - CVE-2023-38254
wordLists:
  fileURLs:
    - https://github.com/akto-api-security/tests-library/raw/akto_resources/resources/heavy%20files/file.csv
    - https://github.com/akto-api-security/tests-library/raw/akto_resources/resources/heavy%20files/heavy-pdf.pdf
    - https://raw.githubusercontent.com/akto-api-security/tests-library/akto_resources/resources/heavy%20files/meme.png
    - https://raw.githubusercontent.com/akto-api-security/tests-library/akto_resources/resources/heavy%20files/heavy-xml.xml
    - https://raw.githubusercontent.com/akto-api-security/tests-library/akto_resources/resources/heavy%20files/video.mp4
    - https://raw.githubusercontent.com/akto-api-security/tests-library/akto_resources/resources/heavy%20files/photo.jpeg
api_selection_filters:
  response_code:
    gte: 200
    lt: 300
execute:
  type: multiple
  requests:
  - req:
    - add_header:
        dummy_Header_Key: "dummyValue"
    - validate:
        response_payload:
          percentage_match:
            gte: 90
    - success: x2
    - failure: exit
  - req:
    - attach_file: ${fileURLs}
    - validate:
        response_code:
          gt: 505
validate:
  and:
    - compare_greater:
        - ${x2.response.stats.median_response_time}
        - 3001
    - compare_greater:
        - ${x2.response.stats.median_response_time}
        - ${x1.response.stats.median_response_time} * 3
strategy:
  run_once: /