id: REMOVE_CAPTCHA
info:
  name: "Remove Captcha from request"
  description: "Ignoring CAPTCHA validation without the field present in the backend server can result in severe damage and vulnerabilities."
  details: >
    "By neglecting CAPTCHA validation when the field is absent, the backend server becomes vulnerable to significant damage."
    "Hackers can exploit this loophole to gain unauthorized access, engage in malicious activities, compromise privacy, and cause financial losses or service disruptions."
  impact: "Bypassing CAPTCHA protection enables hackers to automate malicious activities, such as unauthorized account access, spamming, data harvesting, and DDoS attacks."
  category:
    name: RL
    shortName: Lack of Resources & Rate Limiting
    displayName: Lack of Resources & Rate Limiting (RL)
  subCategory: REMOVE_CAPTCHA
  severity: MEDIUM
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://hackerone.com/reports/124173"
  cwe:
    - CWE-287
    - CWE-294
  cve:
    - CVE-2021-37417

attributes:
  nature: NON-INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
  HIPAA:
    - 45 CFR ยง 164.308(a)(7)(i)
    - 45 CFR ยง 164.312(e)(1)
  SOC 2:
    - System Availability and Performance Management
    - Resource Allocation and Monitoring
  PCI DSS:
    - Requirement 6.5.10
    - Requirement 12.1
  ISO 27001:
    - A.12.1.3
    - A.14.1.3
  NIST 800-53:
    - SC-5
    - SI-13
  CSA CCM:
    - IVS-03
    - TVM-02
  CIS Controls:
    - IG2 Safeguard 9.1
    - IG2 Safeguard 13.10
  FedRAMP:
    - SC-5
    - AU-2
  NIST 800-171:
    - 3.1.3
    - 3.14.3
  FISMA:
    - SC-5
    - AU-2
  Cybersecurity Maturity Model Certification (CMMC):
    - SC.3.192
    - AU.3.048
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    not_contains:
      - invalid
      - error
      - failed
  or:
    - request_payload:
        for_one:
          key:
            contains_either: captcha
            extract: captcha_key
    - query_param:
        for_one:
          key:
            contains_either: captcha
            extract: captcha_key

execute:
  type: single
  requests:
    - req:
        - delete_body_param: ${captcha_key}
        - delete_query_param: ${captcha_key}

validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    percentage_match:
      gt: 80
    length:
      gt: 0
    not_contains:
      - invalid
      - error
      - failed
