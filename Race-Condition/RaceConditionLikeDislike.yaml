id: RACE_CONDITION_LIKE_DISLIKE
info:
  name: Race condition in like/dislike API
  description: Attacker can like/dislike a video multiple times by exploiting race condition vulnerability
  details: > 
      In a normal scenario, the user will arrive at the billing stage on which payment details are sent to the application, only after the order was concluded by the user, and all other data was received.
      However, re-submitting the "update" request right after the "billing" request, might end up with paying for less than what we managed to order.
  impact: A typical TOCTOU vulnerability, allowing an attacker to steal from the DVSA by submitting out-of-order requests
  tags:
    - DVSA
    - TOCTOU
  references:
    - "https://github.com/OWASP/DVSA/blob/c04e0a536ac54db8f732144be92b5f208169f8c4/CONTENT/AWS/LESSONS/LESSON_08.md#81-race-condition"

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    and:
      or:
        regex: .*like.*
        regex: .*vote.*
      contains_either:
        comment
        comments
        video
        videos

execute:
  type: single

validate:
  response_code:
    and:
      gte: 200
      lt: 300
  response_payload:
    percentage_match:
      gt: 90
  
