id: TRACK_METHOD_TEST
info:
  name: TRACK Method Vulnerability Test
  description: "The endpoint appears to accept requests with TRACK HTTP Method. The original request was replayed by replacing the method value with TRACK. The application responded with 2XX success code."
  details: >
    "The endpoint appears to be vulnerable to unsafe HTTP methods attack. The original request was  replayed by replacing the method value with TRACK. The server responded with 2XX success code.
    "<b>Background:</b> The TRACK method is used to invoke a remote, application-layer loop- back of  the request message. TRACK allows the client to see what is being received at the other end of the  request chain and use that data for testing or diagnostic information.
  impact: "TRACK method can be used for debugging purposes. It repeats the content of a request, and an attacker could steal credentials by using a client-side attack."
  category:
    name: UHM
    shortName: Unnecessary HTTP Methods
    displayName: Unnecessary HTTP Methods (UHM)
  subCategory: TRACK_METHOD_TEST
  severity: LOW
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://www.onwebsecurity.com/security/unsafe-http-methods.html"
    - "https://hackerone.com/reports/83837"
  cwe:
    - CWE-16
  cve:
    - CVE-2021-35233

attributes:
  nature: INTRUSIVE
  plan: FREE
  duration: FAST
compliance_standards:
  GDPR:
    - Article 32
  HIPAA:
    - 45 CFR ยง 164.312(c)(1)
    - 45 CFR ยง 164.312(e)(1)
  SOC 2:
    - System and Communication Security
    - Vulnerability and Configuration Management
  PCI DSS:
    - Requirement 6.5.9
    - Requirement 11.3
  ISO 27001:
    - A.12.6.1
    - A.14.2.5
  NIST 800-53:
    - SC-7
    - CM-6
  CSA CCM:
    - IVS-09
    - TVM-03
  CIS Controls:
    - IG1 Safeguard 4.5
    - IG2 Safeguard 13.10
  FedRAMP:
    - SC-7
    - CM-6
  NIST 800-171:
    - 3.1.3
    - 3.14.1
  FISMA:
    - SC-7
    - CM-6
  Cybersecurity Maturity Model Certification (CMMC):
    - SC.1.175
    - CM.2.068
api_selection_filters:
  method:
    neq: "OPTIONS"
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0

execute:
  type: single
  requests:
    - req:
        - modify_method: TRACK
        - add_header:
            new_test_header: test_val

validate:
  response_code:
    gte: 200
    lt: 300
  response_payload:
    length:
      gt: 0
  response_headers:
    for_one:
      key:
        eq: new_test_header
